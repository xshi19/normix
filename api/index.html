

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Reference &mdash; normix 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Generalized Effective Number of Bets" href="../theory/generalized_enb.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            normix
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos.html">Demos &amp; Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory/index.html">Mathematical Background</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-normix.base.distribution">Base Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cache-infrastructure">Cache infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.base.distribution.Distribution"><code class="docutils literal notranslate"><span class="pre">Distribution</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily"><code class="docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.base.mixture.JointNormalMixture"><code class="docutils literal notranslate"><span class="pre">JointNormalMixture</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.base.mixture.NormalMixture"><code class="docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-normix.distributions.univariate.exponential">Univariate Distributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.exponential.Exponential"><code class="docutils literal notranslate"><span class="pre">Exponential</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.gamma.Gamma"><code class="docutils literal notranslate"><span class="pre">Gamma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.inverse_gamma.InverseGamma"><code class="docutils literal notranslate"><span class="pre">InverseGamma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian"><code class="docutils literal notranslate"><span class="pre">InverseGaussian</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.generalized_inverse_gaussian.GIG"><code class="docutils literal notranslate"><span class="pre">GIG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian"><code class="docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-normix.distributions.multivariate.normal">Multivariate Distributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#internal-storage">Internal storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.multivariate.normal.MVN"><code class="docutils literal notranslate"><span class="pre">MVN</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.multivariate.normal.MultivariateNormal"><code class="docutils literal notranslate"><span class="pre">MultivariateNormal</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-normix.distributions.mixtures.variance_gamma">Mixture Distributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma"><code class="docutils literal notranslate"><span class="pre">VarianceGamma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma"><code class="docutils literal notranslate"><span class="pre">NormalInverseGamma</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian"><code class="docutils literal notranslate"><span class="pre">NormalInverseGaussian</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic"><code class="docutils literal notranslate"><span class="pre">GeneralizedHyperbolic</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_det_sigma_one"><code class="docutils literal notranslate"><span class="pre">regularize_det_sigma_one()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_fix_p"><code class="docutils literal notranslate"><span class="pre">regularize_fix_p()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_none"><code class="docutils literal notranslate"><span class="pre">regularize_none()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_sigma_diagonal_one"><code class="docutils literal notranslate"><span class="pre">regularize_sigma_diagonal_one()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-normix.utils.bessel">Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#normix.utils.bessel.kv_ratio"><code class="docutils literal notranslate"><span class="pre">kv_ratio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.utils.bessel.log_kv"><code class="docutils literal notranslate"><span class="pre">log_kv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.utils.bessel.log_kv_derivative_z"><code class="docutils literal notranslate"><span class="pre">log_kv_derivative_z()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#normix.utils.bessel.log_kv_vectorized"><code class="docutils literal notranslate"><span class="pre">log_kv_vectorized()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">normix</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/xshi19/normix/blob/main/docs/api/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="module-normix.base.distribution">
<span id="base-classes"></span><h2>Base Classes<a class="headerlink" href="#module-normix.base.distribution" title="Link to this heading"></a></h2>
<p>Base class for probability distributions with scipy-like API.</p>
<p>This module provides an abstract base class that defines the standard interface
for probability distributions, similar to <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>.</p>
<p>The API includes:</p>
<ul class="simple">
<li><p><strong>Density functions</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">pdf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">logpdf()</span></code></p></li>
<li><p><strong>Cumulative distribution</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">cdf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sf()</span></code> (survival function)</p></li>
<li><p><strong>Quantile functions</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">ppf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">isf()</span></code> (inverse survival)</p></li>
<li><p><strong>Random sampling</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">rvs()</span></code></p></li>
<li><p><strong>Fitting</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code> (returns self for method chaining)</p></li>
<li><p><strong>Moments</strong>: <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">var()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">std()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">stats()</span></code></p></li>
</ul>
<section id="cache-infrastructure">
<h3>Cache infrastructure<a class="headerlink" href="#cache-infrastructure" title="Link to this heading"></a></h3>
<p>All distributions support lazy caching of derived quantities via
<code class="docutils literal notranslate"><span class="pre">functools.cached_property</span></code>. The cache is invalidated by calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_invalidate_cache()</span></code>, which removes all <code class="docutils literal notranslate"><span class="pre">cached_property</span></code> entries
listed in the class-level <code class="xref py py-attr docutils literal notranslate"><span class="pre">_cached_attrs</span></code> tuple.</p>
<p>Subclasses extend <code class="xref py py-attr docutils literal notranslate"><span class="pre">_cached_attrs</span></code> to register their own cached
properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyDist</span><span class="p">(</span><span class="n">ExponentialFamily</span><span class="p">):</span>
    <span class="n">_cached_attrs</span> <span class="o">=</span> <span class="n">ExponentialFamily</span><span class="o">.</span><span class="n">_cached_attrs</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;log_det_Sigma&#39;</span><span class="p">,)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_det_Sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.base.distribution.</span></span><span class="sig-name descname"><span class="pre">Distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for probability distributions.</p>
<p>This class defines the standard API for probability distributions,
similar to scipy.stats distributions. All concrete distributions
should inherit from this class.</p>
<p>The API includes:</p>
<ul class="simple">
<li><p>pdf/pmf: Probability density/mass function</p></li>
<li><p>logpdf/logpmf: Log of the probability density/mass function</p></li>
<li><p>cdf: Cumulative distribution function</p></li>
<li><p>logcdf: Log of the cumulative distribution function</p></li>
<li><p>sf: Survival function (1 - CDF)</p></li>
<li><p>logsf: Log of the survival function</p></li>
<li><p>ppf: Percent point function (inverse of CDF)</p></li>
<li><p>isf: Inverse survival function</p></li>
<li><p>rvs: Random variate sampling</p></li>
<li><p>fit: Fit distribution parameters to data</p></li>
<li><p>stats: Return moments (mean, variance, skewness, kurtosis)</p></li>
<li><p>entropy: Differential entropy of the distribution</p></li>
<li><p>moment: Non-central moment of order n</p></li>
<li><p>median: Median of the distribution</p></li>
<li><p>mean: Mean of the distribution</p></li>
<li><p>var: Variance of the distribution</p></li>
<li><p>std: Standard deviation of the distribution</p></li>
<li><p>interval: Confidence interval</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution._fitted">
<span class="sig-name descname"><span class="pre">_fitted</span></span><a class="headerlink" href="#normix.base.distribution.Distribution._fitted" title="Link to this definition"></a></dt>
<dd><p>Whether parameters have been set (via factory methods, setters, or fit).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution._cached_attrs">
<span class="sig-name descname"><span class="pre">_cached_attrs</span></span><a class="headerlink" href="#normix.base.distribution.Distribution._cached_attrs" title="Link to this definition"></a></dt>
<dd><p>Names of <code class="docutils literal notranslate"><span class="pre">cached_property</span></code> attributes that <code class="xref py py-meth docutils literal notranslate"><span class="pre">_invalidate_cache()</span></code>
will clear. Subclasses extend this via tuple concatenation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – Cumulative probability at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.entropy" title="Link to this definition"></a></dt>
<dd><p>Differential entropy of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>entropy</strong> – Entropy value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.fit">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.distribution.Distribution" title="normix.base.distribution.Distribution"><span class="pre">Distribution</span></a></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution parameters to data (sklearn-style).</p>
<p>This method should fit the distribution parameters to the given data
and return self for method chaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em>) – Data to fit the distribution to.</p></li>
<li><p><strong>*args</strong> – Additional parameters for fitting.</p></li>
<li><p><strong>**kwargs</strong> – Additional parameters for fitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted distribution instance (for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.distribution.Distribution" title="normix.base.distribution.Distribution">Distribution</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.interval">
<span class="sig-name descname"><span class="pre">interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.interval" title="Link to this definition"></a></dt>
<dd><p>Confidence interval with equal areas around the median.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<em>float</em>) – Confidence level (between 0 and 1).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>a, b</strong> – Lower and upper bounds of the confidence interval.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.isf">
<span class="sig-name descname"><span class="pre">isf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.isf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.isf" title="Link to this definition"></a></dt>
<dd><p>Inverse survival function (inverse of SF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>array_like</em>) – Probabilities at which to evaluate the ISF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>isf</strong> – Quantiles corresponding to the given survival probabilities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.kurtosis">
<span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.kurtosis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.kurtosis" title="Link to this definition"></a></dt>
<dd><p>Kurtosis of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kurtosis</strong> – Kurtosis value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.logcdf">
<span class="sig-name descname"><span class="pre">logcdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.logcdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.logcdf" title="Link to this definition"></a></dt>
<dd><p>Log of the cumulative distribution function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the log CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logcdf</strong> – Log cumulative probability at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.logpdf">
<span class="sig-name descname"><span class="pre">logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.logpdf" title="Link to this definition"></a></dt>
<dd><p>Log of the probability density function.</p>
<p>Default implementation: log(pdf(x))
Subclasses should override for numerical stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the log PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log probability density at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.logsf">
<span class="sig-name descname"><span class="pre">logsf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.logsf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.logsf" title="Link to this definition"></a></dt>
<dd><p>Log of the survival function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the log survival function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logsf</strong> – Log survival probability at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.median">
<span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.median" title="Link to this definition"></a></dt>
<dd><p>Median of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>median</strong> – Median value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.moment">
<span class="sig-name descname"><span class="pre">moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.moment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.moment" title="Link to this definition"></a></dt>
<dd><p>Non-central moment of order n.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – Order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moment</strong> – n-th moment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.pdf">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.pdf" title="Link to this definition"></a></dt>
<dd><p>Probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Probability density at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.ppf">
<span class="sig-name descname"><span class="pre">ppf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.ppf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.ppf" title="Link to this definition"></a></dt>
<dd><p>Percent point function (inverse of CDF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>array_like</em>) – Probabilities at which to evaluate the PPF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ppf</strong> – Quantiles corresponding to the given probabilities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.rvs">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.rvs" title="Link to this definition"></a></dt>
<dd><p>Random variate sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of the output. If None, returns a scalar.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Random state for reproducibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rvs</strong> – Random variates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or scalar</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.score" title="Link to this definition"></a></dt>
<dd><p>Compute the mean log-likelihood (sklearn-style scoring).</p>
<p>This method follows the sklearn convention where higher scores are better.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Data samples.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored. Present for sklearn API compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – Mean log-likelihood.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.sf">
<span class="sig-name descname"><span class="pre">sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.sf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.sf" title="Link to this definition"></a></dt>
<dd><p>Survival function (1 - CDF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the survival function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sf</strong> – Survival probability at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.skewness">
<span class="sig-name descname"><span class="pre">skewness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.skewness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.skewness" title="Link to this definition"></a></dt>
<dd><p>Skewness of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>skewness</strong> – Skewness value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.stats">
<span class="sig-name descname"><span class="pre">stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mv'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.stats" title="Link to this definition"></a></dt>
<dd><p>Return moments of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>moments</strong> (<em>str</em><em>, </em><em>optional</em>) – Composed of letters [‘mvsk’] defining which moments to compute:
‘m’ = mean, ‘v’ = variance, ‘s’ = skewness, ‘k’ = kurtosis.
Default is ‘mv’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stats</strong> – Requested moments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.std" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>std</strong> – Standard deviation value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.distribution.Distribution.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/distribution.html#Distribution.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.distribution.Distribution.var" title="Link to this definition"></a></dt>
<dd><p>Variance of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance value(s).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.base.exponential_family">Base class for exponential family distributions.</p>
<p>Exponential families have the canonical form:</p>
<div class="math notranslate nohighlight">
\[p(x|\theta) = h(x) \exp(\theta^T t(x) - \psi(\theta))\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta\)</span>: natural parameters (d-dimensional vector)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x)\)</span>: sufficient statistics (d-dimensional vector)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta)\)</span>: log partition function (cumulant generating function)</p></li>
<li><p><span class="math notranslate nohighlight">\(h(x)\)</span>: base measure</p></li>
</ul>
<p>The log partition function satisfies:</p>
<div class="math notranslate nohighlight">
\[\nabla\psi(\theta) = E[t(X)] = \eta\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> are the expectation parameters.</p>
<p>Supports three parametrizations:</p>
<ul class="simple">
<li><p><strong>Classical</strong>: Domain-specific parameters (e.g., <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span> for Normal)</p></li>
<li><p><strong>Natural</strong>: <span class="math notranslate nohighlight">\(\theta\)</span> in the exponential family form (numpy array)</p></li>
<li><p><strong>Expectation</strong>: <span class="math notranslate nohighlight">\(\eta = \nabla\psi(\theta) = E[t(X)]\)</span> (numpy array)</p></li>
</ul>
<p>The Fisher information matrix equals the Hessian of the log partition:</p>
<div class="math notranslate nohighlight">
\[I(\theta) = \nabla^2\psi(\theta) = \text{Cov}[t(X)]\]</div>
<dl class="py class">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.base.exponential_family.</span></span><span class="sig-name descname"><span class="pre">ExponentialFamily</span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.distribution.Distribution" title="normix.base.distribution.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a></p>
<p>Abstract base class for exponential family distributions.</p>
<p>Exponential family distributions have the probability density:</p>
<div class="math notranslate nohighlight">
\[p(x|\theta) = h(x) \exp(\theta^T t(x) - \psi(\theta))\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta\)</span> are the natural parameters (d-dimensional vector)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x)\)</span> are the sufficient statistics (d-dimensional vector)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta)\)</span> is the log partition function (scalar)</p></li>
<li><p><span class="math notranslate nohighlight">\(h(x)\)</span> is the base measure (scalar)</p></li>
</ul>
<p>Three parametrizations:</p>
<ul class="simple">
<li><p><strong>Classical</strong>: Domain-specific (e.g., <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span> for Normal;
<span class="math notranslate nohighlight">\(\lambda\)</span> for Exponential)</p></li>
<li><p><strong>Natural</strong>: <span class="math notranslate nohighlight">\(\theta\)</span> in exponential family form (numpy array)</p></li>
<li><p><strong>Expectation</strong>: <span class="math notranslate nohighlight">\(\eta = \nabla\psi(\theta) = E[t(X)]\)</span> (numpy array)</p></li>
</ul>
<p>Subclasses must implement the following state management methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_set_from_classical(**kwargs)</span></code>: Set internal state from classical params.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_set_from_natural(theta)</span></code>: Set internal state from natural params.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_compute_natural_params()</span></code>: Derive natural params from internal state.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_compute_classical_params()</span></code>: Derive classical params from internal state.</p></li>
</ul>
<p>Parameters should be stored as named internal attributes (e.g., <code class="docutils literal notranslate"><span class="pre">_rate</span></code>,
<code class="docutils literal notranslate"><span class="pre">_mu</span></code>, <code class="docutils literal notranslate"><span class="pre">_L</span></code>) for efficient direct access. There is no <code class="docutils literal notranslate"><span class="pre">_natural_params</span></code>
tuple at this level; named attributes are the single source of truth.</p>
<p>Both interfaces use <code class="docutils literal notranslate"><span class="pre">functools.cached_property</span></code> for lazy caching of
derived parametrizations, with <code class="docutils literal notranslate"><span class="pre">_invalidate_cache()</span></code> clearing all
entries when state changes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily._fitted">
<span class="sig-name descname"><span class="pre">_fitted</span></span><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily._fitted" title="Link to this definition"></a></dt>
<dd><p>Whether parameters have been set (inherited from Distribution).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Use factory methods to create instances:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># From classical parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># From natural parameters (array)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># From expectation parameters (array)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_expectation_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data (returns self for method chaining)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The log partition function <span class="math notranslate nohighlight">\(\psi(\theta)\)</span> is convex, and its gradient
and Hessian give important quantities:</p>
<ul class="simple">
<li><p>Gradient: <span class="math notranslate nohighlight">\(\nabla\psi(\theta) = E[t(X)] = \eta\)</span> (expectation parameters)</p></li>
<li><p>Hessian: <span class="math notranslate nohighlight">\(\nabla^2\psi(\theta) = \text{Cov}[t(X)] = I(\theta)\)</span> (Fisher information)</p></li>
</ul>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families
in statistical theory.</p>
<dl class="py property">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.classical_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">classical_params</span></span><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.classical_params" title="Link to this definition"></a></dt>
<dd><p>Classical parameters as a frozen dataclass or dict (cached).</p>
<p>Computed lazily from internal state via <code class="docutils literal notranslate"><span class="pre">_compute_classical_params</span></code>.
For migrated subclasses, returns a frozen dataclass with attribute
access (e.g., <code class="docutils literal notranslate"><span class="pre">params.rate</span></code>). For legacy subclasses, returns a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – Classical parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dataclass or dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.expectation_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">expectation_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.expectation_params" title="Link to this definition"></a></dt>
<dd><p>Expectation parameters <span class="math notranslate nohighlight">\(\eta = E[t(X)]\)</span> (cached).</p>
<p>Computed lazily from internal state via <code class="docutils literal notranslate"><span class="pre">_compute_expectation_params</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eta</strong> – Expectation parameter vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Compute Fisher information matrix: I(theta) = Hessian of psi(theta).</p>
<p>The Fisher information equals:</p>
<div class="math notranslate nohighlight">
\[I(\theta) = \nabla^2\psi(\theta) = \text{Cov}[t(X)]\]</div>
<p>It is the Hessian of the log partition function (always positive semi-definite
since <span class="math notranslate nohighlight">\(\psi\)</span> is convex), and equals the covariance matrix of the
sufficient statistics.</p>
<p>Default implementation uses <code class="docutils literal notranslate"><span class="pre">scipy.differentiate.hessian</span></code>.
Override for analytical Hessian when available (recommended for performance).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Natural parameter vector <span class="math notranslate nohighlight">\(\theta\)</span>. If None, uses current parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fisher</strong> – Fisher information matrix (positive semi-definite).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape <code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">d)</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fisher</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fisher_information</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fisher</span><span class="p">)</span>  <span class="c1"># [[0.25]] for rate=2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution parameters using Maximum Likelihood Estimation.</p>
<p>For exponential families, the MLE has a closed form in expectation parameters:</p>
<div class="math notranslate nohighlight">
\[\hat{\eta} = \frac{1}{n} \sum_{i=1}^n t(x_i)\]</div>
<p>That is, the MLE of expectation parameters equals the sample mean
of sufficient statistics. Then converts to natural parameters using
<code class="docutils literal notranslate"><span class="pre">_expectation_to_natural</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored (for sklearn API compatibility).</p></li>
<li><p><strong>**kwargs</strong> – Additional options (currently unused).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining (sklearn convention).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">classical_params</span><span class="p">)</span>
<span class="go">{&#39;rate&#39;: 2.01...}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.from_classical_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_classical_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.from_classical_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.from_classical_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from classical parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Distribution-specific classical parameters.
E.g., rate=2.0 for Exponential, mu=0.0, sigma=1.0 for Normal.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Normal</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.from_expectation_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_expectation_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.from_expectation_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.from_expectation_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from expectation parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eta</strong> (<em>ndarray</em>) – Expectation parameter vector (E[t(X)]).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_expectation_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Normal</span><span class="o">.</span><span class="n">from_expectation_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.from_natural_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_natural_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.from_natural_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.from_natural_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from natural parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em>) – Natural parameter vector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Normal</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.logpdf">
<span class="sig-name descname"><span class="pre">logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.logpdf" title="Link to this definition"></a></dt>
<dd><p>Log probability density using exponential family form.</p>
<p>Computes:</p>
<div class="math notranslate nohighlight">
\[\log p(x|\theta) = \log h(x) + \theta^T t(x) - \psi(\theta)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate log PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log probability density at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.natural_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">natural_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.natural_params" title="Link to this definition"></a></dt>
<dd><p>Natural parameters <span class="math notranslate nohighlight">\(\theta\)</span> as numpy array (cached).</p>
<p>Computed lazily from internal state via <code class="docutils literal notranslate"><span class="pre">_compute_natural_params</span></code>.
Cache is invalidated when parameters change.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> – Natural parameter vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.pdf" title="Link to this definition"></a></dt>
<dd><p>Probability density: p(x|θ) = exp(logpdf(x)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Probability density at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.score" title="Link to this definition"></a></dt>
<dd><p>Compute mean log-likelihood (sklearn-style scoring).</p>
<p>Higher scores are better (sklearn convention).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Data samples.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored (for sklearn API compatibility).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – Mean log-likelihood.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.set_classical_params">
<span class="sig-name descname"><span class="pre">set_classical_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.set_classical_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.set_classical_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from classical parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Distribution-specific classical parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.set_expectation_params">
<span class="sig-name descname"><span class="pre">set_expectation_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.set_expectation_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.set_expectation_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from expectation parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta</strong> (<em>ndarray</em>) – Expectation parameter vector (E[t(X)]).</p></li>
<li><p><strong>theta0</strong> (<em>ndarray</em><em> or </em><em>list</em><em> of </em><em>ndarray</em><em>, </em><em>optional</em>) – Initial guess(es) for natural parameters in optimization.
If provided, these are used instead of the default initial points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.exponential_family.ExponentialFamily.set_natural_params">
<span class="sig-name descname"><span class="pre">set_natural_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span></span><a class="reference internal" href="../_modules/normix/base/exponential_family.html#ExponentialFamily.set_natural_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.exponential_family.ExponentialFamily.set_natural_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from natural parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em>) – Natural parameter vector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.base.mixture">Base classes for normal mixture distributions.</p>
<p>Normal mixture distributions have the form:</p>
<div class="math notranslate nohighlight">
\[X \stackrel{d}{=} \mu + \gamma Y + \sqrt{Y} Z\]</div>
<p>where <span class="math notranslate nohighlight">\(Z \sim N(0, \Sigma)\)</span> is a Gaussian random vector independent of
<span class="math notranslate nohighlight">\(Y\)</span>, and <span class="math notranslate nohighlight">\(Y\)</span> follows some positive mixing distribution (GIG, Gamma,
Inverse Gaussian, etc.).</p>
<p>This module provides two abstract base classes:</p>
<ol class="arabic simple">
<li><p><strong>JointNormalMixture</strong>: The joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> which IS an
exponential family. This class extends <code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code>.</p></li>
<li><p><strong>NormalMixture</strong>: The marginal distribution <span class="math notranslate nohighlight">\(f(x) = \int f(x, y) dy\)</span>
which is NOT an exponential family. This class extends <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code>
and owns a <a class="reference internal" href="#normix.base.mixture.JointNormalMixture" title="normix.base.mixture.JointNormalMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">JointNormalMixture</span></code></a> instance accessible via the <code class="docutils literal notranslate"><span class="pre">.joint</span></code>
property.</p></li>
</ol>
<p>The key insight is that while the marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> (with
<span class="math notranslate nohighlight">\(Y\)</span> integrated out) does not belong to the exponential family, the
joint distribution <span class="math notranslate nohighlight">\((X, Y)\)</span> does belong to the exponential family
when both variables are observed.</p>
<p>Method naming convention:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pdf(x)</span></code>: Marginal PDF <span class="math notranslate nohighlight">\(f(x)\)</span> (on NormalMixture)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">joint.pdf(x,</span> <span class="pre">y)</span></code>: Joint PDF <span class="math notranslate nohighlight">\(f(x, y)\)</span> (via .joint property)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf_joint(x,</span> <span class="pre">y)</span></code>: Convenience alias for <code class="docutils literal notranslate"><span class="pre">joint.pdf(x,</span> <span class="pre">y)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvs(size)</span></code>: Sample from marginal (returns X only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvs_joint(size)</span></code>: Sample from joint (returns X, Y tuple)</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.base.mixture.</span></span><span class="sig-name descname"><span class="pre">JointNormalMixture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for joint normal mixture distributions <span class="math notranslate nohighlight">\(f(x, y)\)</span>.</p>
<p>The joint distribution of <span class="math notranslate nohighlight">\((X, Y)\)</span> where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}X | Y \sim N(\mu + \gamma Y, \Sigma Y)\\Y \sim \text{Mixing distribution}\end{aligned}\end{align} \]</div>
<p>This joint distribution belongs to the exponential family with sufficient
statistics:</p>
<div class="math notranslate nohighlight">
\[\begin{split}t(x, y) = \begin{pmatrix} \log y \\ y^{-1} \\ y \\ x \\ x y^{-1} \\ x x^T y^{-1} \end{pmatrix}\end{split}\]</div>
<p>The natural parameters are derived from the classical parameters
<span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma, \text{mixing params})\)</span>.</p>
<p>Subclasses must implement:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_mixing_distribution_class()</span></code>: Return the mixing distribution class</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_store_mixing_params()</span></code>: Store mixing params from kwargs</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_store_mixing_params_from_theta()</span></code>: Extract mixing params from theta</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_compute_mixing_theta()</span></code>: Build theta_1, theta_2, theta_3</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_create_mixing_distribution()</span></code>: Construct mixing dist from named attrs</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture._d">
<span class="sig-name descname"><span class="pre">_d</span></span><a class="headerlink" href="#normix.base.mixture.JointNormalMixture._d" title="Link to this definition"></a></dt>
<dd><p>Dimension of the observed variable <span class="math notranslate nohighlight">\(X\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></dt><dd><p>Marginal distribution (owns a JointNormalMixture)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></dt><dd><p>Parent class providing exponential family methods</p>
</dd>
</dl>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.L_Sigma_inv">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">L_Sigma_inv</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.L_Sigma_inv" title="Link to this definition"></a></dt>
<dd><p>Inverse of the lower Cholesky factor of Sigma (cached).</p>
<p><span class="math notranslate nohighlight">\(L_\Sigma^{-1}\)</span> such that <span class="math notranslate nohighlight">\(\Sigma^{-1} = L_\Sigma^{-T} L_\Sigma^{-1}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>L_inv</strong> – Lower triangular matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray, shape <code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">d)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.conditional_cov_x_given_y">
<span class="sig-name descname"><span class="pre">conditional_cov_x_given_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.conditional_cov_x_given_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.conditional_cov_x_given_y" title="Link to this definition"></a></dt>
<dd><p>Conditional covariance <span class="math notranslate nohighlight">\(\text{Cov}[X | Y = y] = \Sigma y\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>array_like</em>) – Conditioning value(s) of Y.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cov</strong> – Conditional covariance of X given Y.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.conditional_mean_x_given_y">
<span class="sig-name descname"><span class="pre">conditional_mean_x_given_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.conditional_mean_x_given_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.conditional_mean_x_given_y" title="Link to this definition"></a></dt>
<dd><p>Conditional mean <span class="math notranslate nohighlight">\(E[X | Y = y] = \mu + \gamma y\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>array_like</em>) – Conditioning value(s) of Y.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mean</strong> – Conditional mean of X given Y.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.cov" title="Link to this definition"></a></dt>
<dd><p>Covariance of the joint distribution.</p>
<div class="math notranslate nohighlight">
\[\text{Cov}[X] = E[Y] \Sigma + \text{Var}[Y] \gamma \gamma^T\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>Cov_X</strong> (<em>ndarray</em>) – Covariance matrix of X, shape (d, d)</p></li>
<li><p><strong>Var_Y</strong> (<em>float</em>) – Variance of Y from the mixing distribution</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.d">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">d</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.d" title="Link to this definition"></a></dt>
<dd><p>Dimension of the observed variable X.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.gamma_mahal_sq">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">gamma_mahal_sq</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.gamma_mahal_sq" title="Link to this definition"></a></dt>
<dd><p><span class="math notranslate nohighlight">\(\gamma^T \Sigma^{-1} \gamma\)</span> (cached).</p>
<p>Used in marginal PDF computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mahal_sq</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mahalanobis norm of gamma</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.log_det_Sigma">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">log_det_Sigma</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.log_det_Sigma" title="Link to this definition"></a></dt>
<dd><p>Log-determinant of the covariance scale matrix (cached).</p>
<div class="math notranslate nohighlight">
\[\log|\Sigma| = 2 \sum_{i=1}^d \log (L_\Sigma)_{ii}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_det</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.logpdf">
<span class="sig-name descname"><span class="pre">logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.logpdf" title="Link to this definition"></a></dt>
<dd><p>Log joint probability density using Cholesky-based computation.</p>
<p>Decomposes as <span class="math notranslate nohighlight">\(\log f(x,y) = \log f(x|y) + \log f_Y(y)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\log f(x|y) = -\frac{d}{2}\log(2\pi y)
- \frac{1}{2}\log|\Sigma|
- \frac{1}{2y}(x-\mu-\gamma y)^T \Sigma^{-1}(x-\mu-\gamma y)\]</div>
<p>Uses <code class="docutils literal notranslate"><span class="pre">solve_triangular</span></code> with the stored Cholesky factor
<span class="math notranslate nohighlight">\(L_\Sigma\)</span> instead of constructing the full natural parameter
vector and sufficient statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Observed values of X. Shape (d,) or (n, d).</p></li>
<li><p><strong>y</strong> (<em>array_like</em>) – Observed values of Y. Shape () or (n,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log joint density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>E_X</strong> (<em>ndarray</em>) – <span class="math notranslate nohighlight">\(E[X] = \mu + \gamma E[Y]\)</span></p></li>
<li><p><strong>E_Y</strong> (<em>float</em>) – <span class="math notranslate nohighlight">\(E[Y]\)</span> from the mixing distribution</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.pdf" title="Link to this definition"></a></dt>
<dd><p>Joint probability density function <span class="math notranslate nohighlight">\(f(x, y)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Observed values of X. Shape (d,) or (n, d).</p></li>
<li><p><strong>y</strong> (<em>array_like</em>) – Observed values of Y. Shape () or (n,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Joint density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the joint distribution.</p>
<p>Samples <span class="math notranslate nohighlight">\((X, Y)\)</span> pairs where:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(Y \sim\)</span> mixing distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(X | Y \sim N(\mu + \gamma Y, \Sigma Y)\)</span></p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Number of samples to generate. If None, returns single sample.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator or seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – Sampled X values. Shape (d,) if size is None, (n, d) otherwise.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Sampled Y values. Shape () if size is None, (n,) otherwise.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.JointNormalMixture.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#JointNormalMixture.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.JointNormalMixture.var" title="Link to this definition"></a></dt>
<dd><p>Variance of the joint distribution (diagonal of covariance).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>Var_X</strong> (<em>ndarray</em>) – Variance of X (diagonal of covariance matrix)</p></li>
<li><p><strong>Var_Y</strong> (<em>float</em>) – Variance of Y from the mixing distribution</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.base.mixture.</span></span><span class="sig-name descname"><span class="pre">NormalMixture</span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.distribution.Distribution" title="normix.base.distribution.Distribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for marginal normal mixture distributions <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>The marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> where:</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy = \int_0^\infty f(x | y) f(y) \, dy\]</div>
<p>This marginal distribution is NOT an exponential family. However, the joint
distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family and can be accessed
via the <a class="reference internal" href="#normix.base.mixture.NormalMixture.joint" title="normix.base.mixture.NormalMixture.joint"><code class="xref py py-attr docutils literal notranslate"><span class="pre">joint</span></code></a> property.</p>
<p>Method naming convention:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pdf(x)</span></code>: Marginal PDF <span class="math notranslate nohighlight">\(f(x)\)</span> (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">joint.pdf(x,</span> <span class="pre">y)</span></code>: Joint PDF <span class="math notranslate nohighlight">\(f(x, y)\)</span> (via .joint property)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf_joint(x,</span> <span class="pre">y)</span></code>: Convenience alias for <code class="docutils literal notranslate"><span class="pre">joint.pdf(x,</span> <span class="pre">y)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvs(size)</span></code>: Sample from marginal (returns X only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rvs_joint(size)</span></code>: Sample from joint (returns X, Y tuple)</p></li>
</ul>
<p>Subclasses must implement:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_create_joint_distribution()</span></code>: Factory method to create the joint dist</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_marginal_logpdf()</span></code>: Compute the marginal log PDF</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_conditional_expectation_y_given_x()</span></code>: E[Y | X] for EM algorithm</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture._joint">
<span class="sig-name descname"><span class="pre">_joint</span></span><a class="headerlink" href="#normix.base.mixture.NormalMixture._joint" title="Link to this definition"></a></dt>
<dd><p>The underlying joint distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.JointNormalMixture" title="normix.base.mixture.JointNormalMixture">JointNormalMixture</a> or None</p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#normix.base.mixture.JointNormalMixture" title="normix.base.mixture.JointNormalMixture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JointNormalMixture</span></code></a></dt><dd><p>Joint distribution (exponential family)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Distribution</span></code></dt><dd><p>Parent class defining the scipy-like API</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access marginal distribution methods (default)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Marginal PDF f(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Sample X values only</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access joint distribution methods via .joint property</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">sufficient_statistics</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Exponential family stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convenience aliases for joint methods</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">pdf_joint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Same as gh.joint.pdf(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">rvs_joint</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Returns (X, Y) tuple</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.classical_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">classical_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.classical_params" title="Link to this definition"></a></dt>
<dd><p>Classical parameters of the distribution.</p>
<p>Delegates to the joint distribution’s classical parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – Dictionary of classical parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.cov" title="Link to this definition"></a></dt>
<dd><p>Covariance matrix of the marginal distribution.</p>
<div class="math notranslate nohighlight">
\[\text{Cov}[X] = E[Y] \Sigma + \text{Var}[Y] \gamma \gamma^T\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cov</strong> – Covariance matrix, shape (d, d).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.d">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">d</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.d" title="Link to this definition"></a></dt>
<dd><p>Dimension of the distribution.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.expectation_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">expectation_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.expectation_params" title="Link to this definition"></a></dt>
<dd><p>Expectation parameters <span class="math notranslate nohighlight">\(\eta = E[t(X, Y)]\)</span> of the joint.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eta</strong> – Expectation parameter vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution to data using EM algorithm.</p>
<p>When only X is observed (Y is latent), uses the EM algorithm.
For complete data (both X and Y observed), use <a class="reference internal" href="#normix.base.mixture.NormalMixture.fit_complete" title="normix.base.mixture.NormalMixture.fit_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_complete()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d).</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored.</p></li>
<li><p><strong>**kwargs</strong> – Additional fitting parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not yet implemented. Placeholder for EM algorithm.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.fit_complete">
<span class="sig-name descname"><span class="pre">fit_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.fit_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.fit_complete" title="Link to this definition"></a></dt>
<dd><p>Fit distribution from complete data (both X and Y observed).</p>
<p>Since the joint distribution is an exponential family, this uses
closed-form MLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d).</p></li>
<li><p><strong>Y</strong> (<em>array_like</em>) – Observed Y data, shape (n_samples,).</p></li>
<li><p><strong>**kwargs</strong> – Additional fitting parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not yet implemented.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.from_classical_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_classical_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.from_classical_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.from_classical_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from classical parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Distribution-specific classical parameters.
Common parameters:
- mu : Location parameter (d,)
- gamma : Skewness parameter (d,)
- sigma : Covariance scale matrix (d, d)
- Plus mixing distribution parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.from_expectation_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_expectation_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.from_expectation_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.from_expectation_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from expectation parameters.</p>
<p>The expectation parameters are those of the joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eta</strong> (<em>ndarray</em>) – Expectation parameter vector for the joint distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.from_natural_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_natural_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.from_natural_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.from_natural_params" title="Link to this definition"></a></dt>
<dd><p>Create distribution from natural parameters.</p>
<p>The natural parameters are those of the joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em>) – Natural parameter vector for the joint distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance with parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.joint">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">joint</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#normix.base.mixture.JointNormalMixture" title="normix.base.mixture.JointNormalMixture"><span class="pre">JointNormalMixture</span></a></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.joint" title="Link to this definition"></a></dt>
<dd><p>Access the joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span>.</p>
<p>The joint distribution is an <code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code> with all
associated methods (natural parameters, sufficient statistics,
Fisher information, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>joint</strong> – The underlying joint distribution instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#normix.base.mixture.JointNormalMixture" title="normix.base.mixture.JointNormalMixture">JointNormalMixture</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">sufficient_statistics</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Sufficient stats</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.logpdf">
<span class="sig-name descname"><span class="pre">logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.logpdf" title="Link to this definition"></a></dt>
<dd><p>Log marginal probability density function <span class="math notranslate nohighlight">\(\log f(x)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the log PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log probability density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.logpdf_joint">
<span class="sig-name descname"><span class="pre">logpdf_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.logpdf_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.logpdf_joint" title="Link to this definition"></a></dt>
<dd><p>Log joint probability density function <span class="math notranslate nohighlight">\(\log f(x, y)\)</span>.</p>
<p>Convenience alias for <code class="docutils literal notranslate"><span class="pre">self.joint.logpdf(x,</span> <span class="pre">y)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Observed X values.</p></li>
<li><p><strong>y</strong> (<em>array_like</em>) – Observed Y values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log joint density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the marginal distribution.</p>
<div class="math notranslate nohighlight">
\[E[X] = \mu + \gamma E[Y]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean vector of X, shape (d,).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.mixing_distribution">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">mixing_distribution</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><span class="pre">ExponentialFamily</span></a></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.mixing_distribution" title="Link to this definition"></a></dt>
<dd><p>Access the mixing distribution of Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixing</strong> – The mixing distribution (e.g., GIG, Gamma, InverseGaussian).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily">ExponentialFamily</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.natural_params">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">natural_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.base.mixture.NormalMixture.natural_params" title="Link to this definition"></a></dt>
<dd><p>Natural parameters <span class="math notranslate nohighlight">\(\theta\)</span> of the joint distribution.</p>
<p>Note: The marginal distribution itself is not an exponential family,
so these are the natural parameters of the joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> – Natural parameter vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.pdf" title="Link to this definition"></a></dt>
<dd><p>Marginal probability density function <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate the PDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Probability density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.pdf_joint">
<span class="sig-name descname"><span class="pre">pdf_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.pdf_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.pdf_joint" title="Link to this definition"></a></dt>
<dd><p>Joint probability density function <span class="math notranslate nohighlight">\(f(x, y)\)</span>.</p>
<p>Convenience alias for <code class="docutils literal notranslate"><span class="pre">self.joint.pdf(x,</span> <span class="pre">y)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Observed X values.</p></li>
<li><p><strong>y</strong> (<em>array_like</em>) – Observed Y values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pdf</strong> – Joint density values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the marginal distribution.</p>
<p>Samples X values only (Y is integrated out).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Number of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator or seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> – Sampled X values. Shape <code class="docutils literal notranslate"><span class="pre">(d,)</span></code> if size is None, else <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">d)</span></code> or
<code class="docutils literal notranslate"><span class="pre">(*size,</span> <span class="pre">d)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.rvs_joint">
<span class="sig-name descname"><span class="pre">rvs_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.rvs_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.rvs_joint" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the joint distribution.</p>
<p>Samples both X and Y values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Number of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator or seed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – Sampled X values.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Sampled Y values (latent mixing variable).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.set_classical_params">
<span class="sig-name descname"><span class="pre">set_classical_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.set_classical_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.set_classical_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from classical parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Distribution-specific classical parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.set_expectation_params">
<span class="sig-name descname"><span class="pre">set_expectation_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.set_expectation_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.set_expectation_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from expectation parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eta</strong> (<em>ndarray</em>) – Expectation parameter vector for the joint distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.set_natural_params">
<span class="sig-name descname"><span class="pre">set_natural_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><span class="pre">NormalMixture</span></a></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.set_natural_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.set_natural_params" title="Link to this definition"></a></dt>
<dd><p>Set parameters from natural parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em>) – Natural parameter vector for the joint distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Returns self for method chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture">NormalMixture</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.std" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the marginal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>std</strong> – Standard deviation of each component, shape (d,).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.base.mixture.NormalMixture.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/base/mixture.html#NormalMixture.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.base.mixture.NormalMixture.var" title="Link to this definition"></a></dt>
<dd><p>Variance of the marginal distribution (diagonal of covariance).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of each component, shape (d,).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-normix.distributions.univariate.exponential">
<span id="univariate-distributions"></span><h2>Univariate Distributions<a class="headerlink" href="#module-normix.distributions.univariate.exponential" title="Link to this heading"></a></h2>
<p>Exponential distribution as an exponential family.</p>
<p>The Exponential distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\lambda) = \lambda e^{-\lambda x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x \geq 0\)</span>, where <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> is the rate parameter.</p>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1\)</span> for <span class="math notranslate nohighlight">\(x \geq 0\)</span> (base measure)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = x\)</span> (sufficient statistic)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = -\lambda\)</span> (natural parameter)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = -\log(-\theta)\)</span> (log partition function)</p></li>
</ul>
<p>Parametrizations:</p>
<ul class="simple">
<li><p>Classical: <span class="math notranslate nohighlight">\(\lambda\)</span> (rate), <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span></p></li>
<li><p>Natural: <span class="math notranslate nohighlight">\(\theta = -\lambda\)</span>, <span class="math notranslate nohighlight">\(\theta &lt; 0\)</span></p></li>
<li><p>Expectation: <span class="math notranslate nohighlight">\(\eta = E[X] = 1/\lambda\)</span>, <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span></p></li>
</ul>
<p>Note: scipy uses scale = 1/rate parametrization.</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.exponential.</span></span><span class="sig-name descname"><span class="pre">Exponential</span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Exponential distribution in exponential family form.</p>
<p>The Exponential distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\lambda) = \lambda e^{-\lambda x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x \geq 0\)</span>, where <span class="math notranslate nohighlight">\(\lambda\)</span> is the rate parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Rate parameter <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(rate=...)</span></code>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential._natural_params">
<span class="sig-name descname"><span class="pre">_natural_params</span></span><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential._natural_params" title="Link to this definition"></a></dt>
<dd><p>Internal storage for natural parameters <span class="math notranslate nohighlight">\(\theta = -\lambda\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from rate parameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">0.5</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Exponential</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gamma</span></code></dt><dd><p>Generalization of Exponential (Exponential is Gamma with <span class="math notranslate nohighlight">\(\alpha = 1\)</span>)</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Exponential distribution is a special case of the Gamma distribution
with shape parameter <span class="math notranslate nohighlight">\(\alpha = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{Exponential}(\lambda) = \text{Gamma}(1, \lambda)\]</div>
<p>Exponential family form:</p>
<ul class="simple">
<li><p>Sufficient statistic: <span class="math notranslate nohighlight">\(t(x) = x\)</span></p></li>
<li><p>Natural parameter: <span class="math notranslate nohighlight">\(\theta = -\lambda\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = -\log(-\theta)\)</span></p></li>
</ul>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function: F(x) = 1 - exp(-λx) for x ≥ 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – CDF values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Analytical Fisher information: I(theta) = 1/theta^2.</p>
<p>The Fisher information matrix (Hessian of log partition) is:</p>
<div class="math notranslate nohighlight">
\[I(\theta) = \frac{1}{\theta^2} = \frac{1}{\lambda^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Natural parameter vector. If None, uses current parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fisher</strong> – Fisher information matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (1, 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of Exponential distribution: E[X] = 1/lambda.</p>
<div class="math notranslate nohighlight">
\[E[X] = \frac{1}{\lambda}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the exponential distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator seed or instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Random samples from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.exponential.Exponential.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/exponential.html#Exponential.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.exponential.Exponential.var" title="Link to this definition"></a></dt>
<dd><p>Variance of Exponential distribution: Var[X] = 1/lambda^2.</p>
<div class="math notranslate nohighlight">
\[\text{Var}[X] = \frac{1}{\lambda^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.univariate.gamma">Gamma distribution as an exponential family.</p>
<p>The Gamma distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\alpha, \beta) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span> is the shape parameter and
<span class="math notranslate nohighlight">\(\beta &gt; 0\)</span> is the rate parameter.</p>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1\)</span> for <span class="math notranslate nohighlight">\(x &gt; 0\)</span> (base measure)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = [\log x, x]\)</span> (sufficient statistics)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = [\alpha - 1, -\beta]\)</span> (natural parameters)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = \log\Gamma(\theta_1 + 1) - (\theta_1 + 1)\log(-\theta_2)\)</span> (log partition)</p></li>
</ul>
<p>Parametrizations:</p>
<ul class="simple">
<li><p>Classical: <span class="math notranslate nohighlight">\(\alpha\)</span> (shape), <span class="math notranslate nohighlight">\(\beta\)</span> (rate), <span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span></p></li>
<li><p>Natural: <span class="math notranslate nohighlight">\(\theta = [\alpha - 1, -\beta]\)</span>, <span class="math notranslate nohighlight">\(\theta_1 &gt; -1, \theta_2 &lt; 0\)</span></p></li>
<li><p>Expectation: <span class="math notranslate nohighlight">\(\eta = [\psi(\alpha) - \log\beta, \alpha/\beta]\)</span>, where
<span class="math notranslate nohighlight">\(\psi\)</span> is the digamma function</p></li>
</ul>
<p>Note: scipy uses scale = 1/rate parametrization.</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.gamma.</span></span><span class="sig-name descname"><span class="pre">Gamma</span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Gamma distribution in exponential family form.</p>
<p>The Gamma distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\alpha, \beta) = \frac{\beta^\alpha}{\Gamma(\alpha)}
x^{\alpha-1} e^{-\beta x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\alpha\)</span> is the shape parameter
and <span class="math notranslate nohighlight">\(\beta\)</span> is the rate parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>float</em><em>, </em><em>optional</em>) – Shape parameter <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(shape=...,</span> <span class="pre">rate=...)</span></code>.</p></li>
<li><p><strong>rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Rate parameter <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(shape=...,</span> <span class="pre">rate=...)</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma._natural_params">
<span class="sig-name descname"><span class="pre">_natural_params</span></span><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma._natural_params" title="Link to this definition"></a></dt>
<dd><p>Internal storage for natural parameters <span class="math notranslate nohighlight">\(\theta = [\alpha - 1, -\beta]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from shape and rate parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Gamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">2.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Gamma</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InverseGamma</span></code></dt><dd><p>Inverse of Gamma distribution</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></dt><dd><p>Generalization including Gamma as special case</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Exponential</span></code></dt><dd><p>Special case of Gamma with <span class="math notranslate nohighlight">\(\alpha = 1\)</span></p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Gamma distribution belongs to the exponential family with:</p>
<ul class="simple">
<li><p>Sufficient statistics: <span class="math notranslate nohighlight">\(t(x) = [\log x, x]\)</span></p></li>
<li><p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = [\alpha - 1, -\beta]\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = \log\Gamma(\theta_1 + 1) - (\theta_1 + 1)\log(-\theta_2)\)</span></p></li>
</ul>
<p>The expectation parameters are:</p>
<div class="math notranslate nohighlight">
\[\eta = [\psi(\alpha) - \log\beta, \alpha/\beta]\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi\)</span> is the digamma function.</p>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function using scipy’s implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – CDF values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Analytical Fisher information: I(theta) = Hessian of psi(theta).</p>
<p>The Fisher information matrix (Hessian of log partition) is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}I(\theta) = \begin{pmatrix} \psi'(\alpha) &amp; 1/\beta \\
1/\beta &amp; \alpha/\beta^2 \end{pmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi'\)</span> is the trigamma function, <span class="math notranslate nohighlight">\(\alpha = \theta_1 + 1\)</span>,
and <span class="math notranslate nohighlight">\(\beta = -\theta_2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Natural parameter vector. If None, uses current parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fisher</strong> – Fisher information matrix (positive definite).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (2, 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of Gamma distribution: E[X] = alpha/beta.</p>
<div class="math notranslate nohighlight">
\[E[X] = \frac{\alpha}{\beta}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator seed or instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Random samples from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.gamma.Gamma.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/gamma.html#Gamma.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.gamma.Gamma.var" title="Link to this definition"></a></dt>
<dd><p>Variance of Gamma distribution: Var[X] = alpha/beta^2.</p>
<div class="math notranslate nohighlight">
\[\text{Var}[X] = \frac{\alpha}{\beta^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.univariate.inverse_gamma">Inverse Gamma distribution as an exponential family.</p>
<p>The Inverse Gamma distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\alpha, \beta) = \frac{\beta^\alpha}{\Gamma(\alpha)}
x^{-\alpha-1} e^{-\beta/x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span> is the shape parameter
and <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span> is the rate parameter.</p>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1\)</span> for <span class="math notranslate nohighlight">\(x &gt; 0\)</span> (base measure)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = [-1/x, \log x]\)</span> (sufficient statistics)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = [\beta, -(\alpha+1)]\)</span> (natural parameters)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = \log\Gamma(-\theta_2-1) - (-\theta_2-1)\log(\theta_1)\)</span> (log partition)</p></li>
</ul>
<p>Parametrizations:</p>
<ul class="simple">
<li><p>Classical: <span class="math notranslate nohighlight">\(\alpha\)</span> (shape), <span class="math notranslate nohighlight">\(\beta\)</span> (rate), <span class="math notranslate nohighlight">\(\alpha &gt; 0, \beta &gt; 0\)</span></p></li>
<li><p>Natural: <span class="math notranslate nohighlight">\(\theta = [\beta, -(\alpha+1)]\)</span>, <span class="math notranslate nohighlight">\(\theta_1 &gt; 0, \theta_2 &lt; -1\)</span></p></li>
<li><p>Expectation: <span class="math notranslate nohighlight">\(\eta = [-\alpha/\beta, \log\beta - \psi(\alpha)]\)</span>, where
<span class="math notranslate nohighlight">\(\psi\)</span> is the digamma function</p></li>
</ul>
<p>Note: We use rate <span class="math notranslate nohighlight">\(\beta\)</span> (like Gamma), while scipy uses scale = <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.inverse_gamma.</span></span><span class="sig-name descname"><span class="pre">InverseGamma</span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Inverse Gamma distribution in exponential family form.</p>
<p>The Inverse Gamma distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\alpha, \beta) = \frac{\beta^\alpha}{\Gamma(\alpha)}
x^{-\alpha-1} e^{-\beta/x}\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\alpha\)</span> is the shape parameter
and <span class="math notranslate nohighlight">\(\beta\)</span> is the rate parameter.</p>
<p>If <span class="math notranslate nohighlight">\(X \sim \text{Gamma}(\alpha, \beta)\)</span>, then <span class="math notranslate nohighlight">\(1/X \sim \text{InvGamma}(\alpha, \beta)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>float</em><em>, </em><em>optional</em>) – Shape parameter <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(shape=...,</span> <span class="pre">rate=...)</span></code>.</p></li>
<li><p><strong>rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Rate parameter <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(shape=...,</span> <span class="pre">rate=...)</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma._natural_params">
<span class="sig-name descname"><span class="pre">_natural_params</span></span><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma._natural_params" title="Link to this definition"></a></dt>
<dd><p>Internal storage for natural parameters <span class="math notranslate nohighlight">\(\theta = [\beta, -(\alpha+1)]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from shape and rate parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">0.75</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGamma</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">invgamma</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">invgamma</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGamma</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gamma</span></code></dt><dd><p>Inverse of InverseGamma distribution</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></dt><dd><p>Generalization including InverseGamma as special case</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Inverse Gamma distribution belongs to the exponential family with:</p>
<ul class="simple">
<li><p>Sufficient statistics: <span class="math notranslate nohighlight">\(t(x) = [-1/x, \log x]\)</span></p></li>
<li><p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = [\beta, -(\alpha+1)]\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = \log\Gamma(-\theta_2-1) - (-\theta_2-1)\log(\theta_1)\)</span></p></li>
</ul>
<p>The mean exists only for <span class="math notranslate nohighlight">\(\alpha &gt; 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[E[X] = \frac{\beta}{\alpha - 1}\]</div>
<p>The variance exists only for <span class="math notranslate nohighlight">\(\alpha &gt; 2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{Var}[X] = \frac{\beta^2}{(\alpha-1)^2(\alpha-2)}\]</div>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function using scipy’s implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – CDF values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Analytical Fisher information: I(θ) = ∇²ψ(θ).</p>
<p>The Hessian is:
I₁₁ = α/β²
I₁₂ = I₂₁ = 1/β
I₂₂ = ψ’(α) (trigamma function)</p>
<p>where α = -θ₂-1, β = θ₁.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of Inverse Gamma distribution: E[X] = beta/(alpha-1) for alpha &gt; 1.</p>
<div class="math notranslate nohighlight">
\[E[X] = \frac{\beta}{\alpha - 1} \quad \text{for } \alpha &gt; 1\]</div>
<p>Returns infinity if <span class="math notranslate nohighlight">\(\alpha \leq 1\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean of the distribution, or infinity if undefined.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the inverse gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator seed or instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Random samples from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gamma.InverseGamma.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gamma.html#InverseGamma.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gamma.InverseGamma.var" title="Link to this definition"></a></dt>
<dd><p>Variance of Inverse Gamma distribution for alpha &gt; 2.</p>
<div class="math notranslate nohighlight">
\[\text{Var}[X] = \frac{\beta^2}{(\alpha-1)^2(\alpha-2)} \quad \text{for } \alpha &gt; 2\]</div>
<p>Returns infinity if <span class="math notranslate nohighlight">\(\alpha \leq 2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of the distribution, or infinity if undefined.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.univariate.inverse_gaussian">Inverse Gaussian distribution (Wald distribution).</p>
<p>Special case of GIG with <span class="math notranslate nohighlight">\(p = -1/2\)</span>.
Also belongs to the exponential family.</p>
<p>The Inverse Gaussian distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\delta, \eta) = \sqrt{\frac{\eta}{2\pi x^3}}
\exp\left(-\frac{\eta(x-\delta)^2}{2\delta^2 x}\right)\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\delta &gt; 0\)</span> is the mean and <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>
is the shape parameter.</p>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1/\sqrt{2\pi x^3}\)</span> for <span class="math notranslate nohighlight">\(x &gt; 0\)</span> (base measure)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = [x, 1/x]\)</span> (sufficient statistics)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = [-\eta/(2\delta^2), -\eta/2]\)</span> (natural parameters)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = -2\sqrt{\theta_1\theta_2} - \frac{1}{2}\log(-2\theta_2)\)</span> (log partition)</p></li>
</ul>
<p>Parametrizations:</p>
<ul class="simple">
<li><p>Classical: <span class="math notranslate nohighlight">\(\delta\)</span> (mean), <span class="math notranslate nohighlight">\(\eta\)</span> (shape), <span class="math notranslate nohighlight">\(\delta &gt; 0, \eta &gt; 0\)</span></p></li>
<li><p>Natural: <span class="math notranslate nohighlight">\(\theta = [-\eta/(2\delta^2), -\eta/2]\)</span>, <span class="math notranslate nohighlight">\(\theta_1 &lt; 0, \theta_2 &lt; 0\)</span></p></li>
<li><p>Expectation: <span class="math notranslate nohighlight">\(\eta_{exp} = [\delta, 1/\delta + 1/\eta]\)</span></p></li>
</ul>
<p>Note: scipy uses (mu, scale) where:</p>
<ul class="simple">
<li><p>scipy_mu = <span class="math notranslate nohighlight">\(\delta/\eta\)</span> (shape parameter, confusingly named)</p></li>
<li><p>scipy_scale = <span class="math notranslate nohighlight">\(\eta\)</span> (our shape parameter)</p></li>
<li><p>Relationship: <span class="math notranslate nohighlight">\(\delta = \text{scipy\_mu} \times \text{scipy\_scale}\)</span>,
<span class="math notranslate nohighlight">\(\eta = \text{scipy\_scale}\)</span></p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.inverse_gaussian.</span></span><span class="sig-name descname"><span class="pre">InverseGaussian</span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Inverse Gaussian distribution in exponential family form.</p>
<p>Also known as the Wald distribution. Special case of GIG with <span class="math notranslate nohighlight">\(p = -1/2\)</span>.</p>
<p>The Inverse Gaussian distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\delta, \eta) = \sqrt{\frac{\eta}{2\pi x^3}}
\exp\left(-\frac{\eta(x-\delta)^2}{2\delta^2 x}\right)\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(\delta\)</span> is the mean and <span class="math notranslate nohighlight">\(\eta\)</span>
is the shape parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Mean parameter <span class="math notranslate nohighlight">\(\delta &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(delta=...,</span> <span class="pre">eta=...)</span></code>.</p></li>
<li><p><strong>eta</strong> (<em>float</em><em>, </em><em>optional</em>) – Shape parameter <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>. Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(delta=...,</span> <span class="pre">eta=...)</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from classical parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGaussian</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">1.0</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGaussian</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">invgauss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">invgauss</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">InverseGaussian</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></dt><dd><p>Generalization with parameter <span class="math notranslate nohighlight">\(p\)</span></p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Inverse Gaussian distribution belongs to the exponential family with:</p>
<ul class="simple">
<li><p>Sufficient statistics: <span class="math notranslate nohighlight">\(t(x) = [x, 1/x]\)</span></p></li>
<li><p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = [-\eta/(2\delta^2), -\eta/2]\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = -2\sqrt{\theta_1\theta_2} - \frac{1}{2}\log(-2\theta_2)\)</span></p></li>
</ul>
<p>It is a special case of the Generalized Inverse Gaussian (GIG) with <span class="math notranslate nohighlight">\(p = -1/2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\text{InvGauss}(\delta, \eta) = \text{GIG}(p=-1/2, a=\eta/\delta^2, b=\eta)\]</div>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<p>Chhikara, R. S. &amp; Folks, J. L. (1989). The Inverse Gaussian Distribution.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function using scipy’s implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – CDF values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Analytical Fisher information: <span class="math notranslate nohighlight">\(I(\theta) = \nabla^2\psi(\theta)\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of Inverse Gaussian distribution: <span class="math notranslate nohighlight">\(E[X] = \delta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the inverse Gaussian distribution.</p>
<p>Uses numpy’s wald distribution which has the same parameterization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator seed or instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Random samples from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.inverse_gaussian.InverseGaussian.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/inverse_gaussian.html#InverseGaussian.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.inverse_gaussian.InverseGaussian.var" title="Link to this definition"></a></dt>
<dd><p>Variance of Inverse Gaussian distribution: <span class="math notranslate nohighlight">\(\text{Var}[X] = \delta^3/\eta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.univariate.generalized_inverse_gaussian">Generalized Inverse Gaussian (GIG) distribution.</p>
<p>The GIG distribution belongs to the exponential family and serves as a
unifying framework for many important distributions.</p>
<p>The GIG distribution has PDF (Wikipedia parameterization):</p>
<div class="math notranslate nohighlight">
\[f(x|p,a,b) = \frac{(a/b)^{p/2}}{2 K_p(\sqrt{ab})} x^{p-1}
\exp\left(-\frac{ax + b/x}{2}\right)\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span>: real-valued shape parameter (any real number)</p></li>
<li><p><span class="math notranslate nohighlight">\(a &gt; 0\)</span>: rate parameter (coefficient of <span class="math notranslate nohighlight">\(x\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(b &gt; 0\)</span>: rate parameter (coefficient of <span class="math notranslate nohighlight">\(1/x\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(K_p\)</span> is the modified Bessel function of the second kind</p></li>
</ul>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1\)</span> for <span class="math notranslate nohighlight">\(x &gt; 0\)</span> (base measure)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = [\log x, 1/x, x]\)</span> (sufficient statistics)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = [p-1, -b/2, -a/2]\)</span> (natural parameters)</p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = \log(2) + \log K_p(\sqrt{ab}) + \frac{p}{2}\log(b/a)\)</span> (log partition)</p></li>
</ul>
<p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = (\theta_1, \theta_2, \theta_3)\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta_1 = p - 1\)</span> (unbounded)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_2 = -b/2 &lt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_3 = -a/2 &lt; 0\)</span></p></li>
</ul>
<p>Scipy parametrization (<code class="docutils literal notranslate"><span class="pre">scipy.stats.geninvgauss</span></code>):</p>
<ul class="simple">
<li><p>scipy uses <span class="math notranslate nohighlight">\((p, b_{scipy}, \text{scale})\)</span> where
<span class="math notranslate nohighlight">\(b_{scipy} = \sqrt{ab}\)</span> and <span class="math notranslate nohighlight">\(\text{scale} = \sqrt{b/a}\)</span></p></li>
</ul>
<p>Special cases:</p>
<ul class="simple">
<li><p><strong>Gamma</strong>: <span class="math notranslate nohighlight">\(b \to 0\)</span> gives <span class="math notranslate nohighlight">\(\text{Gamma}(p, a/2)\)</span> for <span class="math notranslate nohighlight">\(p &gt; 0\)</span></p></li>
<li><p><strong>Inverse Gamma</strong>: <span class="math notranslate nohighlight">\(a \to 0\)</span> gives <span class="math notranslate nohighlight">\(\text{InvGamma}(-p, b/2)\)</span> for <span class="math notranslate nohighlight">\(p &lt; 0\)</span></p></li>
<li><p><strong>Inverse Gaussian</strong>: <span class="math notranslate nohighlight">\(p = -1/2\)</span></p></li>
</ul>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Generalized_inverse_Gaussian_distribution">https://en.wikipedia.org/wiki/Generalized_inverse_Gaussian_distribution</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GIG">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.generalized_inverse_gaussian.</span></span><span class="sig-name descname"><span class="pre">GIG</span></span><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GIG" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian" title="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.univariate.generalized_inverse_gaussian.</span></span><span class="sig-name descname"><span class="pre">GeneralizedInverseGaussian</span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Generalized Inverse Gaussian (GIG) distribution in exponential family form.</p>
<p>The GIG distribution has PDF (Wikipedia parameterization):</p>
<div class="math notranslate nohighlight">
\[f(x|p,a,b) = \frac{(a/b)^{p/2}}{2 K_p(\sqrt{ab})} x^{p-1}
\exp\left(-\frac{ax + b/x}{2}\right)\]</div>
<p>for <span class="math notranslate nohighlight">\(x &gt; 0\)</span>, where <span class="math notranslate nohighlight">\(K_p\)</span> is the modified Bessel function
of the second kind.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>optional</em>) – Shape parameter (any real number). Use <code class="docutils literal notranslate"><span class="pre">from_classical_params(p=...,</span> <span class="pre">a=...,</span> <span class="pre">b=...)</span></code>.</p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>optional</em>) – Rate parameter <span class="math notranslate nohighlight">\(a &gt; 0\)</span> (coefficient of <span class="math notranslate nohighlight">\(x\)</span>).</p></li>
<li><p><strong>b</strong> (<em>float</em><em>, </em><em>optional</em>) – Rate parameter <span class="math notranslate nohighlight">\(b &gt; 0\)</span> (coefficient of <span class="math notranslate nohighlight">\(1/x\)</span>).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian._natural_params">
<span class="sig-name descname"><span class="pre">_natural_params</span></span><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian._natural_params" title="Link to this definition"></a></dt>
<dd><p>Internal storage for natural parameters <span class="math notranslate nohighlight">\(\theta = [p-1, -b/2, -a/2]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from classical parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">GeneralizedInverseGaussian</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create from natural parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">GeneralizedInverseGaussian</span><span class="o">.</span><span class="n">from_natural_params</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">geninvgauss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">geninvgauss</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">GeneralizedInverseGaussian</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gamma</span></code></dt><dd><p>Special case when <span class="math notranslate nohighlight">\(b \to 0\)</span> for <span class="math notranslate nohighlight">\(p &gt; 0\)</span></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InverseGamma</span></code></dt><dd><p>Special case when <span class="math notranslate nohighlight">\(a \to 0\)</span> for <span class="math notranslate nohighlight">\(p &lt; 0\)</span></p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InverseGaussian</span></code></dt><dd><p>Special case when <span class="math notranslate nohighlight">\(p = -1/2\)</span></p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The GIG distribution belongs to the exponential family with:</p>
<ul class="simple">
<li><p>Sufficient statistics: <span class="math notranslate nohighlight">\(t(x) = [\log x, 1/x, x]\)</span></p></li>
<li><p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = [p-1, -b/2, -a/2]\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = \log(2) + \log K_p(\sqrt{ab}) + \frac{p}{2}\log(b/a)\)</span></p></li>
</ul>
<p>Moments are given by:</p>
<div class="math notranslate nohighlight">
\[E[X^\alpha] = \left(\frac{b}{a}\right)^{\alpha/2}
\frac{K_{p+\alpha}(\sqrt{ab})}{K_p(\sqrt{ab})}\]</div>
<p>Special cases:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b \to 0, p &gt; 0\)</span>: <span class="math notranslate nohighlight">\(\text{GIG} \to \text{Gamma}(p, a/2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a \to 0, p &lt; 0\)</span>: <span class="math notranslate nohighlight">\(\text{GIG} \to \text{InvGamma}(-p, b/2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p = -1/2\)</span>: <span class="math notranslate nohighlight">\(\text{GIG} \to \text{InverseGaussian}\)</span></p></li>
</ul>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Generalized_inverse_Gaussian_distribution">https://en.wikipedia.org/wiki/Generalized_inverse_Gaussian_distribution</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function.</p>
<p>Uses scipy.stats.geninvgauss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.fisher_information">
<span class="sig-name descname"><span class="pre">fisher_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.fisher_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.fisher_information" title="Link to this definition"></a></dt>
<dd><p>Fisher information matrix I(θ) = ∇²A(θ).</p>
<p>Uses numerical differentiation since the analytical form is complex.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.from_scipy_params">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_scipy_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian" title="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian"><span class="pre">GeneralizedInverseGaussian</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.from_scipy_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.from_scipy_params" title="Link to this definition"></a></dt>
<dd><p>Create from scipy.stats.geninvgauss parameters.</p>
<dl class="simple">
<dt>Conversion:</dt><dd><p>p = p_scipy
a = b_scipy / scale
b = b_scipy * scale</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>float</em>) – Shape parameter.</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Shape parameter b &gt; 0 (this is √(ab) in our notation).</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Scale parameter &gt; 0. Default is 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dist</strong> – Distribution instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian" title="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian">GeneralizedInverseGaussian</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of GIG distribution using Bessel function ratio.</p>
<div class="math notranslate nohighlight">
\[E[X] = \sqrt{\frac{b}{a}} \frac{K_{p+1}(\sqrt{ab})}{K_p(\sqrt{ab})}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.moment_alpha">
<span class="sig-name descname"><span class="pre">moment_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.moment_alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.moment_alpha" title="Link to this definition"></a></dt>
<dd><p>Compute the α-th moment E[X^α].</p>
<p>E[X^α] = (b/a)^(α/2) · K_{p+α}(√(ab)) / K_p(√(ab))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<em>float</em>) – Order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>moment</strong> – The α-th moment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.ppf">
<span class="sig-name descname"><span class="pre">ppf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.ppf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.ppf" title="Link to this definition"></a></dt>
<dd><p>Percent point function (inverse of CDF).</p>
<p>Uses scipy.stats.geninvgauss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scipy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples from the GIG distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Shape of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator seed or instance.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Sampling method: ‘scipy’ uses scipy.stats.geninvgauss (default),
‘naive’ uses inverse CDF method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Random samples from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.to_scipy_params">
<span class="sig-name descname"><span class="pre">to_scipy_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.to_scipy_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.to_scipy_params" title="Link to this definition"></a></dt>
<dd><p>Convert to scipy.stats.geninvgauss parameters (p, b, scale).</p>
<dl class="simple">
<dt>scipy parameterization:</dt><dd><p>f(x|p,b,scale) ∝ (x/scale)^{p-1} exp(-b((x/scale) + scale/x)/2)</p>
</dd>
<dt>Conversion:</dt><dd><p>p_scipy = p
b_scipy = √(ab)
scale = √(b/a)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – Dictionary with keys ‘p’, ‘b’, ‘scale’.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/univariate/generalized_inverse_gaussian.html#GeneralizedInverseGaussian.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.univariate.generalized_inverse_gaussian.GeneralizedInverseGaussian.var" title="Link to this definition"></a></dt>
<dd><p>Variance of GIG distribution: Var[X] = E[X^2] - E[X]^2.</p>
<div class="math notranslate nohighlight">
\[\text{Var}[X] = E[X^2] - (E[X])^2\]</div>
<p>Uses the moment formula <span class="math notranslate nohighlight">\(E[X^\alpha] = (b/a)^{\alpha/2} K_{p+\alpha}(\sqrt{ab})/K_p(\sqrt{ab})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance of the distribution.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-normix.distributions.multivariate.normal">
<span id="multivariate-distributions"></span><h2>Multivariate Distributions<a class="headerlink" href="#module-normix.distributions.multivariate.normal" title="Link to this heading"></a></h2>
<p>Multivariate Normal distribution as an exponential family.</p>
<p>The multivariate Normal distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\mu,\Sigma) = (2\pi)^{-d/2} |\Sigma|^{-1/2}
\exp\left(-\frac{1}{2} (x-\mu)^T \Sigma^{-1} (x-\mu)\right)\]</div>
<p>for <span class="math notranslate nohighlight">\(x \in \mathbb{R}^d\)</span>, where <span class="math notranslate nohighlight">\(\mu\)</span> is the mean vector
and <span class="math notranslate nohighlight">\(\Sigma\)</span> is the covariance matrix.</p>
<p>Exponential family form:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(h(x) = 1\)</span> (base measure, with <span class="math notranslate nohighlight">\((2\pi)^{-d/2}\)</span> absorbed into <span class="math notranslate nohighlight">\(\psi\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(t(x) = [x, \text{vec}(xx^T)]\)</span> (sufficient statistics)</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta = [\Lambda\mu, -\frac{1}{2}\text{vec}(\Lambda)]\)</span> where <span class="math notranslate nohighlight">\(\Lambda = \Sigma^{-1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\psi(\theta) = \frac{1}{2}\mu^T\Lambda\mu - \frac{1}{2}\log|\Lambda| + \frac{d}{2}\log(2\pi)\)</span></p></li>
</ul>
<p>Parametrizations:</p>
<ul class="simple">
<li><p>Classical: <span class="math notranslate nohighlight">\(\mu\)</span> (mean, d-vector), <span class="math notranslate nohighlight">\(\Sigma\)</span> (covariance, d×d positive definite)</p></li>
<li><p>Natural: <span class="math notranslate nohighlight">\(\theta = [\eta, \text{vec}(\Lambda_{half})]\)</span> where
<span class="math notranslate nohighlight">\(\eta = \Lambda\mu\)</span>, <span class="math notranslate nohighlight">\(\Lambda_{half} = -\frac{1}{2}\Lambda\)</span></p></li>
<li><p>Expectation: <span class="math notranslate nohighlight">\(\eta = [E[X], E[XX^T]] = [\mu, \Sigma + \mu\mu^T]\)</span></p></li>
</ul>
<p>Supports both univariate (d=1) and multivariate (d&gt;1) cases.
For d=1: <span class="math notranslate nohighlight">\(\mu\)</span> is scalar, <span class="math notranslate nohighlight">\(\Sigma\)</span> is scalar (variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>).</p>
<section id="internal-storage">
<h3>Internal storage<a class="headerlink" href="#internal-storage" title="Link to this heading"></a></h3>
<p>After migration, the distribution stores the Cholesky decomposition of the
covariance matrix rather than the full covariance or its inverse:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_mu</span></code>: mean vector, shape <code class="docutils literal notranslate"><span class="pre">(d,)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_L_Sigma</span></code>: lower Cholesky factor of <span class="math notranslate nohighlight">\(\Sigma\)</span>, shape <code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">d)</span></code></p></li>
</ul>
<p>Derived quantities <code class="docutils literal notranslate"><span class="pre">log_det_Sigma</span></code> and <code class="docutils literal notranslate"><span class="pre">L_inv</span></code> are cached properties,
computed on demand and invalidated when parameters change.</p>
</section>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MVN">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.multivariate.normal.</span></span><span class="sig-name descname"><span class="pre">MVN</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MVN" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#normix.distributions.multivariate.normal.MultivariateNormal" title="normix.distributions.multivariate.normal.MultivariateNormal"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultivariateNormal</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.multivariate.normal.</span></span><span class="sig-name descname"><span class="pre">MultivariateNormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.exponential_family.ExponentialFamily" title="normix.base.exponential_family.ExponentialFamily"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExponentialFamily</span></code></a></p>
<p>Multivariate Normal distribution in exponential family form.</p>
<p>The Multivariate Normal distribution has PDF:</p>
<div class="math notranslate nohighlight">
\[p(x|\mu,\Sigma) = (2\pi)^{-d/2} |\Sigma|^{-1/2}
\exp\left(-\frac{1}{2} (x-\mu)^T \Sigma^{-1} (x-\mu)\right)\]</div>
<p>Supports both univariate (d=1) and multivariate (d&gt;1) cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – Dimension of the distribution. Inferred from parameters if not provided.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal._mu">
<span class="sig-name descname"><span class="pre">_mu</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal._mu" title="Link to this definition"></a></dt>
<dd><p>Mean vector, shape <code class="docutils literal notranslate"><span class="pre">(d,)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal._L_Sigma">
<span class="sig-name descname"><span class="pre">_L_Sigma</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal._L_Sigma" title="Link to this definition"></a></dt>
<dd><p>Lower Cholesky factor of <span class="math notranslate nohighlight">\(\Sigma\)</span>, shape <code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">d)</span></code>.
<span class="math notranslate nohighlight">\(\Sigma = L_\Sigma L_\Sigma^T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal._d">
<span class="sig-name descname"><span class="pre">_d</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal._d" title="Link to this definition"></a></dt>
<dd><p>Dimension of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D case (univariate normal)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNormal</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNormal</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 2.])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit from data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The Multivariate Normal distribution belongs to the exponential family with:</p>
<ul class="simple">
<li><p>Sufficient statistics: <span class="math notranslate nohighlight">\(t(x) = [x, \text{vec}(xx^T)]\)</span></p></li>
<li><p>Natural parameters: <span class="math notranslate nohighlight">\(\theta = [\Lambda\mu, -\frac{1}{2}\text{vec}(\Lambda)]\)</span></p></li>
<li><p>Log partition: <span class="math notranslate nohighlight">\(\psi(\theta) = \frac{1}{2}\eta^T\Sigma\eta - \frac{1}{2}\log|\Lambda| + \frac{d}{2}\log(2\pi)\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\Lambda = \Sigma^{-1}\)</span> is the precision matrix.</p>
<p>The internal storage uses the Cholesky decomposition <span class="math notranslate nohighlight">\(L\)</span> of the
covariance <span class="math notranslate nohighlight">\(\Sigma = LL^T\)</span>, which:</p>
<ul class="simple">
<li><p>Avoids repeated matrix inversions in <code class="docutils literal notranslate"><span class="pre">logpdf</span></code> and <code class="docutils literal notranslate"><span class="pre">rvs</span></code></p></li>
<li><p>Provides numerically stable log-determinant: <span class="math notranslate nohighlight">\(\log|\Sigma| = 2\sum_i \log L_{ii}\)</span></p></li>
<li><p>Enables efficient Mahalanobis distance via <code class="docutils literal notranslate"><span class="pre">solve_triangular</span></code></p></li>
</ul>
<p class="rubric">References</p>
<p>Barndorff-Nielsen, O. E. (1978). Information and exponential families.</p>
<dl class="py property">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.L_inv">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">L_inv</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.L_inv" title="Link to this definition"></a></dt>
<dd><p>Inverse of the lower Cholesky factor (cached).</p>
<p><span class="math notranslate nohighlight">\(L^{-1}\)</span> such that <span class="math notranslate nohighlight">\(\Sigma^{-1} = L^{-T} L^{-1}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>L_inv</strong> – Lower triangular matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray, shape <code class="docutils literal notranslate"><span class="pre">(d,</span> <span class="pre">d)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.cdf" title="Link to this definition"></a></dt>
<dd><p>Cumulative distribution function.</p>
<p>For d=1, uses the univariate normal CDF.
For d&gt;1, uses scipy’s multivariate_normal.cdf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate CDF.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cdf</strong> – CDF values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.cov" title="Link to this definition"></a></dt>
<dd><p>Covariance matrix Σ = L L^T.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.d">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">d</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.d" title="Link to this definition"></a></dt>
<dd><p>Dimension of the distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.entropy" title="Link to this definition"></a></dt>
<dd><p>Differential entropy.</p>
<div class="math notranslate nohighlight">
\[H(X) = \frac{d}{2}(1 + \log(2\pi)) + \frac{1}{2}\log|\Sigma|\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.multivariate.normal.MultivariateNormal" title="normix.distributions.multivariate.normal.MultivariateNormal"><span class="pre">MultivariateNormal</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution parameters using Maximum Likelihood Estimation.</p>
<p>For MVN, the MLE is:
- μ̂ = sample mean
- Σ̂ = sample covariance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Training data. Shape (n_samples, d) or (n_samples,) for 1D.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.multivariate.normal.MultivariateNormal" title="normix.distributions.multivariate.normal.MultivariateNormal">MultivariateNormal</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.from_scipy">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">from_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">&lt;scipy.stats._multivariate.multivariate_normal_gen</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fa91c5bf410&gt;</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.multivariate.normal.MultivariateNormal" title="normix.distributions.multivariate.normal.MultivariateNormal"><span class="pre">MultivariateNormal</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.from_scipy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.from_scipy" title="Link to this definition"></a></dt>
<dd><p>Create from scipy.stats.multivariate_normal.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.log_det_Sigma">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">log_det_Sigma</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.log_det_Sigma" title="Link to this definition"></a></dt>
<dd><p>Log-determinant of the covariance matrix (cached).</p>
<div class="math notranslate nohighlight">
\[\log|\Sigma| = 2 \sum_{i=1}^d \log L_{ii}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_det</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.logpdf">
<span class="sig-name descname"><span class="pre">logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.logpdf" title="Link to this definition"></a></dt>
<dd><p>Log probability density using Cholesky-based computation.</p>
<p>Uses <code class="docutils literal notranslate"><span class="pre">solve_triangular</span></code> instead of <code class="docutils literal notranslate"><span class="pre">np.linalg.inv</span></code> for the
Mahalanobis distance:</p>
<div class="math notranslate nohighlight">
\[\log p(x|\mu,\Sigma) = -\frac{d}{2}\log(2\pi)
- \frac{1}{2}\log|\Sigma|
- \frac{1}{2}(x-\mu)^T \Sigma^{-1}(x-\mu)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Sigma^{-1}(x-\mu) = L^{-T}(L^{-1}(x-\mu))\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array_like</em>) – Points at which to evaluate log PDF.
Shape <code class="docutils literal notranslate"><span class="pre">(d,)</span></code> for single sample, <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">d)</span></code> for n samples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logpdf</strong> – Log probability density at each point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the distribution: E[X] = μ.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.pdf" title="Link to this definition"></a></dt>
<dd><p>Probability density: p(x|θ) = exp(logpdf(x)).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.rvs" title="Link to this definition"></a></dt>
<dd><p>Generate random samples using <span class="math notranslate nohighlight">\(X = \mu + L Z\)</span> where <span class="math notranslate nohighlight">\(Z \sim N(0, I)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>) – Number of samples to generate.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Shape (size, d) for size &gt; 1, (d,) for size = None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.to_scipy">
<span class="sig-name descname"><span class="pre">to_scipy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">&lt;scipy.stats._multivariate.multivariate_normal_gen</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fa91c5bf410&gt;</span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.to_scipy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.to_scipy" title="Link to this definition"></a></dt>
<dd><p>Convert to scipy.stats.multivariate_normal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.multivariate.normal.MultivariateNormal.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/multivariate/normal.html#MultivariateNormal.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.multivariate.normal.MultivariateNormal.var" title="Link to this definition"></a></dt>
<dd><p>Variance (diagonal of covariance matrix).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-normix.distributions.mixtures.variance_gamma">
<span id="mixture-distributions"></span><h2>Mixture Distributions<a class="headerlink" href="#module-normix.distributions.mixtures.variance_gamma" title="Link to this heading"></a></h2>
<p>Variance Gamma (VG) marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>The marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> obtained by integrating out <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy = \int_0^\infty f(x | y) f(y) \, dy\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}X | Y \sim N(\mu + \gamma Y, \Sigma Y)\\Y \sim \text{Gamma}(\alpha, \beta)\end{aligned}\end{align} \]</div>
<p>The marginal PDF has a closed form involving modified Bessel functions:</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{2 \beta^\alpha}{(2\pi)^{d/2} |\Sigma|^{1/2} \Gamma(\alpha)}
\left(\frac{q(x)}{2c}\right)^{(\alpha - d/2)/2}
K_{\alpha - d/2}\left(\sqrt{2 q(x) c}\right)
e^{(x-\mu)^T\Sigma^{-1}\gamma}\]</div>
<p>where <span class="math notranslate nohighlight">\(q(x) = (x-\mu)^T\Sigma^{-1}(x-\mu)\)</span> is the squared Mahalanobis distance
and <span class="math notranslate nohighlight">\(c = \beta + \frac{1}{2}\gamma^T\Sigma^{-1}\gamma\)</span>.</p>
<p>Note: The marginal distribution is NOT an exponential family, but the joint
distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family (accessible via <code class="docutils literal notranslate"><span class="pre">.joint</span></code>).</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.mixtures.variance_gamma.VarianceGamma">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.variance_gamma.</span></span><span class="sig-name descname"><span class="pre">VarianceGamma</span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/variance_gamma.html#VarianceGamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></p>
<p>Variance Gamma (VG) marginal distribution.</p>
<p>The Variance Gamma distribution is a normal variance-mean mixture where
the mixing distribution is Gamma. It is a special case of the Generalized
Hyperbolic distribution with GIG parameter <span class="math notranslate nohighlight">\(b \to 0\)</span>.</p>
<p>The marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span> is NOT an exponential family.
The joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family and can
be accessed via the <code class="docutils literal notranslate"><span class="pre">.joint</span></code> property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>instances.</strong> (<em>None. Use factory methods to create</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.mixtures.variance_gamma.VarianceGamma._joint">
<span class="sig-name descname"><span class="pre">_joint</span></span><a class="headerlink" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma._joint" title="Link to this definition"></a></dt>
<dd><p>The underlying joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>JointVarianceGamma</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vg</span> <span class="o">=</span> <span class="n">VarianceGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">vg</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Samples X only</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access joint distribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vg</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vg</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters (exponential family)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vg</span> <span class="o">=</span> <span class="n">VarianceGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">JointVarianceGamma</span></code></dt><dd><p>Joint distribution (exponential family)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedHyperbolic</span></code></dt><dd><p>General case with GIG mixing</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalInverseGaussian</span></code></dt><dd><p>Special case with Inverse Gaussian mixing</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Variance Gamma distribution has heavier tails than the normal
distribution, controlled by the Gamma shape parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.
Smaller <span class="math notranslate nohighlight">\(\alpha\)</span> leads to heavier tails.</p>
<p>The skewness is controlled by the <span class="math notranslate nohighlight">\(\gamma\)</span> parameter:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma = 0\)</span>: symmetric distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &gt; 0\)</span>: right-skewed</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &lt; 0\)</span>: left-skewed</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.variance_gamma.VarianceGamma.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma" title="normix.distributions.mixtures.variance_gamma.VarianceGamma"><span class="pre">VarianceGamma</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/variance_gamma.html#VarianceGamma.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution to data using the EM algorithm.</p>
<p>Convergence is checked based on the relative change in the normal
parameters <span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma)\)</span>. Log-likelihood is optionally
displayed per iteration when <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored (for sklearn API compatibility).</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of EM iterations. Default is 100.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for relative parameter change.
Default is 1e-3.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level. 0 = silent, 1 = progress with llh,
2 = detailed with parameter norms. Default is 0.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random state for initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma" title="normix.distributions.mixtures.variance_gamma.VarianceGamma">VarianceGamma</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.variance_gamma.VarianceGamma.fit_complete">
<span class="sig-name descname"><span class="pre">fit_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma" title="normix.distributions.mixtures.variance_gamma.VarianceGamma"><span class="pre">VarianceGamma</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/variance_gamma.html#VarianceGamma.fit_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma.fit_complete" title="Link to this definition"></a></dt>
<dd><p>Fit distribution from complete data (both X and Y observed).</p>
<p>Since the joint distribution is an exponential family, this uses
the closed-form MLE via the joint distribution’s fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>Y</strong> (<em>array_like</em>) – Observed Y data (mixing variable), shape (n_samples,).</p></li>
<li><p><strong>**kwargs</strong> – Additional fitting parameters passed to joint.fit().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.variance_gamma.VarianceGamma" title="normix.distributions.mixtures.variance_gamma.VarianceGamma">VarianceGamma</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate complete data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">true_dist</span> <span class="o">=</span> <span class="n">VarianceGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span> <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]),</span> <span class="n">shape</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">true_dist</span><span class="o">.</span><span class="n">rvs_joint</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit with complete data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fitted</span> <span class="o">=</span> <span class="n">VarianceGamma</span><span class="p">()</span><span class="o">.</span><span class="n">fit_complete</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.mixtures.normal_inverse_gamma">Normal Inverse Gamma (NInvG) marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>The marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> obtained by integrating out <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy = \int_0^\infty f(x | y) f(y) \, dy\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}X | Y \sim N(\mu + \gamma Y, \Sigma Y)\\Y \sim \text{InvGamma}(\alpha, \beta)\end{aligned}\end{align} \]</div>
<p>The marginal PDF has a closed form involving modified Bessel functions:</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{2 \beta^\alpha}{(2\pi)^{d/2} |\Sigma|^{1/2} \Gamma(\alpha)}
\left(\frac{q(x)}{2c}\right)^{(\alpha - d/2)/2}
K_{\alpha - d/2}\left(\sqrt{2 q(x) c}\right)
e^{(x-\mu)^T\Sigma^{-1}\gamma}\]</div>
<p>where <span class="math notranslate nohighlight">\(q(x) = (x-\mu)^T\Sigma^{-1}(x-\mu)\)</span> is the squared Mahalanobis distance
and <span class="math notranslate nohighlight">\(c\)</span> depends on the skewness parameter <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<p>Note: The marginal distribution is NOT an exponential family, but the joint
distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family (accessible via <code class="docutils literal notranslate"><span class="pre">.joint</span></code>).</p>
<p>This is a special case of the Generalized Hyperbolic distribution with GIG
parameter <span class="math notranslate nohighlight">\(a \to 0\)</span> (inverse gamma mixing).</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.normal_inverse_gamma.</span></span><span class="sig-name descname"><span class="pre">NormalInverseGamma</span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gamma.html#NormalInverseGamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></p>
<p>Normal Inverse Gamma (NInvG) marginal distribution.</p>
<p>The Normal Inverse Gamma distribution is a normal variance-mean mixture where
the mixing distribution is InverseGamma. It is a special case of the Generalized
Hyperbolic distribution with GIG parameter <span class="math notranslate nohighlight">\(a \to 0\)</span>.</p>
<p>The marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span> is NOT an exponential family.
The joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family and can
be accessed via the <code class="docutils literal notranslate"><span class="pre">.joint</span></code> property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>instances.</strong> (<em>None. Use factory methods to create</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma._joint">
<span class="sig-name descname"><span class="pre">_joint</span></span><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma._joint" title="Link to this definition"></a></dt>
<dd><p>The underlying joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>JointNormalInverseGamma</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span> <span class="o">=</span> <span class="n">NormalInverseGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">shape</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nig</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Samples X only</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access joint distribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters (exponential family)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span> <span class="o">=</span> <span class="n">NormalInverseGamma</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">shape</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">rate</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">JointNormalInverseGamma</span></code></dt><dd><p>Joint distribution (exponential family)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedHyperbolic</span></code></dt><dd><p>General case with GIG mixing</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">VarianceGamma</span></code></dt><dd><p>Special case with Gamma mixing</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Normal Inverse Gamma distribution has heavier tails than the normal
distribution, controlled by the InverseGamma shape parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.
Smaller <span class="math notranslate nohighlight">\(\alpha\)</span> leads to heavier tails.</p>
<p>The skewness is controlled by the <span class="math notranslate nohighlight">\(\gamma\)</span> parameter:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma = 0\)</span>: symmetric distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &gt; 0\)</span>: right-skewed</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &lt; 0\)</span>: left-skewed</p></li>
</ul>
<p>For the mean to exist, we need <span class="math notranslate nohighlight">\(\alpha &gt; 1\)</span>.
For the variance to exist, we need <span class="math notranslate nohighlight">\(\alpha &gt; 2\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma" title="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma"><span class="pre">NormalInverseGamma</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gamma.html#NormalInverseGamma.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution to data using the EM algorithm.</p>
<p>Convergence is checked based on the relative change in the normal
parameters <span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma)\)</span>. Log-likelihood is optionally
displayed per iteration when <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored (for sklearn API compatibility).</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of EM iterations. Default is 100.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for relative parameter change.
Default is 1e-3.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level. 0 = silent, 1 = progress with llh,
2 = detailed with parameter norms. Default is 0.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random state for initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma" title="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma">NormalInverseGamma</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma.fit_complete">
<span class="sig-name descname"><span class="pre">fit_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma" title="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma"><span class="pre">NormalInverseGamma</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gamma.html#NormalInverseGamma.fit_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma.fit_complete" title="Link to this definition"></a></dt>
<dd><p>Fit distribution from complete data (both X and Y observed).</p>
<p>Since the joint distribution is an exponential family, this uses
the closed-form MLE via the joint distribution’s fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>Y</strong> (<em>array_like</em>) – Observed Y data (mixing variable), shape (n_samples,).</p></li>
<li><p><strong>**kwargs</strong> – Additional fitting parameters passed to joint.fit().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma" title="normix.distributions.mixtures.normal_inverse_gamma.NormalInverseGamma">NormalInverseGamma</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.mixtures.normal_inverse_gaussian">Normal Inverse Gaussian (NIG) marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>The marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> obtained by integrating out <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy = \int_0^\infty f(x | y) f(y) \, dy\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}X | Y \sim N(\mu + \gamma Y, \Sigma Y)\\Y \sim \text{InvGauss}(\delta, \eta)\end{aligned}\end{align} \]</div>
<p>The marginal PDF has a closed form involving modified Bessel functions <span class="math notranslate nohighlight">\(K_1\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{\eta \delta}{\pi} \frac{K_1(\eta \sqrt{\delta^2 + q(x)})}{\sqrt{\delta^2 + q(x)}}
e^{\delta \eta + (x-\mu)^T \Sigma^{-1} \gamma}\]</div>
<p>for the univariate case, where <span class="math notranslate nohighlight">\(q(x) = (x-\mu)^T \Sigma^{-1}(x-\mu)\)</span>.</p>
<p>This is a special case of the Generalized Hyperbolic distribution with
GIG parameter <span class="math notranslate nohighlight">\(p = -1/2\)</span>.</p>
<p>Note: The marginal distribution is NOT an exponential family, but the joint
distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family (accessible via <code class="docutils literal notranslate"><span class="pre">.joint</span></code>).</p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.normal_inverse_gaussian.</span></span><span class="sig-name descname"><span class="pre">NormalInverseGaussian</span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gaussian.html#NormalInverseGaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></p>
<p>Normal Inverse Gaussian (NIG) marginal distribution.</p>
<p>The Normal Inverse Gaussian distribution is a normal variance-mean mixture where
the mixing distribution is Inverse Gaussian. It is a special case of the Generalized
Hyperbolic distribution with GIG parameter <span class="math notranslate nohighlight">\(p = -1/2\)</span>.</p>
<p>The marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span> is NOT an exponential family.
The joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family and can
be accessed via the <code class="docutils literal notranslate"><span class="pre">.joint</span></code> property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>instances.</strong> (<em>None. Use factory methods to create</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian._joint">
<span class="sig-name descname"><span class="pre">_joint</span></span><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian._joint" title="Link to this definition"></a></dt>
<dd><p>The underlying joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>JointNormalInverseGaussian</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span> <span class="o">=</span> <span class="n">NormalInverseGaussian</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">eta</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">nig</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Samples X only</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access joint distribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters (exponential family)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nig</span> <span class="o">=</span> <span class="n">NormalInverseGaussian</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">eta</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">JointNormalInverseGaussian</span></code></dt><dd><p>Joint distribution (exponential family)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedHyperbolic</span></code></dt><dd><p>General case with GIG mixing</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">VarianceGamma</span></code></dt><dd><p>Special case with Gamma mixing</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalInverseGamma</span></code></dt><dd><p>Special case with InverseGamma mixing</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The NIG distribution is widely used in finance due to its semi-heavy tails
and ability to model both skewness and excess kurtosis. It was introduced
by Barndorff-Nielsen (1977) and provides a good fit for asset returns.</p>
<p>The skewness is controlled by the <span class="math notranslate nohighlight">\(\gamma\)</span> parameter:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma = 0\)</span>: symmetric distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &gt; 0\)</span>: right-skewed</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma &lt; 0\)</span>: left-skewed</p></li>
</ul>
<p>The tail heaviness is controlled by <span class="math notranslate nohighlight">\(\eta\)</span>: smaller <span class="math notranslate nohighlight">\(\eta\)</span>
gives heavier tails.</p>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian" title="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian"><span class="pre">NormalInverseGaussian</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gaussian.html#NormalInverseGaussian.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution to data using the EM algorithm.</p>
<p>Convergence is checked based on the relative change in the normal
parameters <span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma)\)</span>. Log-likelihood is optionally
displayed per iteration when <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>y</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Ignored (for sklearn API compatibility).</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of EM iterations. Default is 100.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for relative parameter change.
Default is 1e-3.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level. 0 = silent, 1 = progress with llh,
2 = detailed with parameter norms. Default is 0.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em> or </em><em>Generator</em><em>, </em><em>optional</em>) – Random state for initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian" title="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian">NormalInverseGaussian</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian.fit_complete">
<span class="sig-name descname"><span class="pre">fit_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian" title="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian"><span class="pre">NormalInverseGaussian</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/normal_inverse_gaussian.html#NormalInverseGaussian.fit_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian.fit_complete" title="Link to this definition"></a></dt>
<dd><p>Fit distribution from complete data (both X and Y observed).</p>
<p>Since the joint distribution is an exponential family, this uses
the closed-form MLE via the joint distribution’s fit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed X data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>Y</strong> (<em>array_like</em>) – Observed Y data (mixing variable), shape (n_samples,).</p></li>
<li><p><strong>**kwargs</strong> – Additional fitting parameters passed to joint.fit().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian" title="normix.distributions.mixtures.normal_inverse_gaussian.NormalInverseGaussian">NormalInverseGaussian</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-normix.distributions.mixtures.generalized_hyperbolic">Generalized Hyperbolic (GH) marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>The marginal distribution of <span class="math notranslate nohighlight">\(X\)</span> obtained by integrating out <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[f(x) = \int_0^\infty f(x, y) \, dy = \int_0^\infty f(x | y) f(y) \, dy\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}X | Y \sim N(\mu + \gamma Y, \Sigma Y)\\Y \sim \text{GIG}(p, a, b)\end{aligned}\end{align} \]</div>
<p>The marginal PDF has a closed form involving modified Bessel functions.</p>
<p>Note: The marginal distribution is NOT an exponential family, but the joint
distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family (accessible via <code class="docutils literal notranslate"><span class="pre">.joint</span></code>).</p>
<p>Special cases:
- <strong>Variance Gamma (VG)</strong>: <span class="math notranslate nohighlight">\(b \to 0\)</span> (GIG → Gamma)
- <strong>Normal-Inverse Gaussian (NIG)</strong>: <span class="math notranslate nohighlight">\(p = -1/2\)</span> (GIG → InverseGaussian)
- <strong>Normal-Inverse Gamma (NInvG)</strong>: <span class="math notranslate nohighlight">\(a \to 0\)</span> (GIG → InverseGamma)
- <strong>Hyperbolic</strong>: <span class="math notranslate nohighlight">\(p = 1\)</span></p>
<dl class="py class">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.generalized_hyperbolic.</span></span><span class="sig-name descname"><span class="pre">GeneralizedHyperbolic</span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#normix.base.mixture.NormalMixture" title="normix.base.mixture.NormalMixture"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalMixture</span></code></a></p>
<p>Generalized Hyperbolic (GH) marginal distribution.</p>
<p>The Generalized Hyperbolic distribution is a normal variance-mean mixture where
the mixing distribution is Generalized Inverse Gaussian (GIG). It is the most
general form of the normal variance-mean mixture family.</p>
<p>The marginal distribution <span class="math notranslate nohighlight">\(f(x)\)</span> is NOT an exponential family.
The joint distribution <span class="math notranslate nohighlight">\(f(x, y)\)</span> IS an exponential family and can
be accessed via the <code class="docutils literal notranslate"><span class="pre">.joint</span></code> property.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>instances.</strong> (<em>None. Use factory methods to create</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic._joint">
<span class="sig-name descname"><span class="pre">_joint</span></span><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic._joint" title="Link to this definition"></a></dt>
<dd><p>The underlying joint distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>JointGeneralizedHyperbolic</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 1D case</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="o">.</span><span class="n">from_classical_params</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">mu</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]]),</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">gh</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Samples X only</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access joint distribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Joint PDF f(x, y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span><span class="o">.</span><span class="n">joint</span><span class="o">.</span><span class="n">natural_params</span>  <span class="c1"># Natural parameters (exponential family)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit with EM algorithm and regularization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">X</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">regularization</span><span class="o">=</span><span class="s1">&#39;det_sigma_one&#39;</span>  <span class="c1"># or &#39;sigma_diagonal_one&#39;, &#39;fix_p&#39;, &#39;none&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">JointGeneralizedHyperbolic</span></code></dt><dd><p>Joint distribution (exponential family)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralizedInverseGaussian</span></code></dt><dd><p>The mixing distribution for Y</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">VarianceGamma</span></code></dt><dd><p>Special case with Gamma mixing (b → 0)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalInverseGaussian</span></code></dt><dd><p>Special case with p = -1/2</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">NormalInverseGamma</span></code></dt><dd><p>Special case with a → 0</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The GH distribution is widely used in finance for modeling asset returns.
It includes many important distributions as special cases:</p>
<ul class="simple">
<li><p><strong>Variance Gamma (VG)</strong>: <span class="math notranslate nohighlight">\(b \to 0, p &gt; 0\)</span> (Gamma mixing)</p></li>
<li><p><strong>Normal-Inverse Gaussian (NIG)</strong>: <span class="math notranslate nohighlight">\(p = -1/2\)</span> (IG mixing)</p></li>
<li><p><strong>Normal-Inverse Gamma (NInvG)</strong>: <span class="math notranslate nohighlight">\(a \to 0, p &lt; 0\)</span> (InvGamma mixing)</p></li>
<li><p><strong>Hyperbolic</strong>: <span class="math notranslate nohighlight">\(p = 1\)</span></p></li>
<li><p><strong>Student-t</strong>: <span class="math notranslate nohighlight">\(p = -\nu/2, a \to 0, b = \nu\)</span> gives Student-t with ν d.f.</p></li>
</ul>
<p>The model is not identifiable since the parameter sets
<span class="math notranslate nohighlight">\((\mu, \gamma/c, \Sigma/c, p, c \cdot b, a/c)\)</span> give the same distribution
for any <span class="math notranslate nohighlight">\(c &gt; 0\)</span>. Use regularization to fix this.</p>
<p>Available regularization methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'det_sigma_one'</span></code>: Fix <span class="math notranslate nohighlight">\(|\Sigma| = 1\)</span> (recommended)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sigma_diagonal_one'</span></code>: Fix <span class="math notranslate nohighlight">\(\Sigma_{11} = 1\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fix_p'</span></code>: Fix <span class="math notranslate nohighlight">\(p\)</span> to a specific value (e.g., -0.5 for NIG)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'none'</span></code>: No regularization</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_normal_inverse_gamma">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">as_normal_inverse_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic"><span class="pre">GeneralizedHyperbolic</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.as_normal_inverse_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_normal_inverse_gamma" title="Link to this definition"></a></dt>
<dd><p>Create a GH distribution equivalent to Normal-Inverse Gamma.</p>
<p>NInvG is GH with a → 0 (Inverse Gamma mixing).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>gamma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>sigma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>shape</strong> (<em>float</em>) – InverseGamma shape parameter α.</p></li>
<li><p><strong>rate</strong> (<em>float</em>) – InverseGamma rate parameter β.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gh</strong> – GH distribution equivalent to NInvG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic">GeneralizedHyperbolic</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_normal_inverse_gaussian">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">as_normal_inverse_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic"><span class="pre">GeneralizedHyperbolic</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.as_normal_inverse_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_normal_inverse_gaussian" title="Link to this definition"></a></dt>
<dd><p>Create a GH distribution equivalent to Normal-Inverse Gaussian.</p>
<p>NIG is GH with p = -1/2 (Inverse Gaussian mixing).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>gamma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>sigma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – IG mean parameter.</p></li>
<li><p><strong>eta</strong> (<em>float</em>) – IG shape parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gh</strong> – GH distribution equivalent to NIG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic">GeneralizedHyperbolic</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_variance_gamma">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">as_variance_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic"><span class="pre">GeneralizedHyperbolic</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.as_variance_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.as_variance_gamma" title="Link to this definition"></a></dt>
<dd><p>Create a GH distribution equivalent to Variance Gamma.</p>
<p>VG is GH with b → 0 (Gamma mixing).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>gamma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>sigma</strong> (<em>arrays</em>) – Normal parameters.</p></li>
<li><p><strong>shape</strong> (<em>float</em>) – Gamma shape parameter α.</p></li>
<li><p><strong>rate</strong> (<em>float</em>) – Gamma rate parameter β.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gh</strong> – GH distribution equivalent to VG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic">GeneralizedHyperbolic</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.cov" title="Link to this definition"></a></dt>
<dd><p>Covariance matrix of the marginal distribution.</p>
<div class="math notranslate nohighlight">
\[\text{Cov}[X] = E[Y] \Sigma + \text{Var}[Y] \gamma\gamma^T\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cov</strong> – Covariance matrix, shape (d, d).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'det_sigma_one'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_tail</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic"><span class="pre">GeneralizedHyperbolic</span></a></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.fit" title="Link to this definition"></a></dt>
<dd><p>Fit distribution to marginal data X using the EM algorithm.</p>
<p>Since the marginal distribution is not an exponential family, we use
the EM algorithm treating Y as latent. The joint distribution (X, Y)
is an exponential family, which makes the EM algorithm tractable.</p>
<p>Convergence is checked based on the relative change in the normal
parameters <span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma)\)</span>, which are more stable than
the GIG parameters. Log-likelihood is optionally displayed per
iteration when <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array_like</em>) – Observed data, shape (n_samples, d) or (n_samples,) for d=1.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of EM iterations. Default is 100.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence tolerance for relative parameter change (based on
<span class="math notranslate nohighlight">\(\mu, \gamma, \Sigma\)</span>). Default is 1e-4.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level. 0 = silent, 1 = progress with llh,
2 = detailed with parameter norms. Default is 0.</p></li>
<li><p><strong>regularization</strong> (<em>str</em><em> or </em><em>callable</em><em>, </em><em>optional</em>) – <p>Regularization method to use. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'det_sigma_one'</span></code>: Fix <a href="#id1"><span class="problematic" id="id2">|Σ|</span></a> = 1 (recommended, default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sigma_diagonal_one'</span></code>: Fix Σ₁₁ = 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fix_p'</span></code>: Fix p to a specific value (use regularization_params)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'none'</span></code>: No regularization</p></li>
<li><p>Or provide a custom callable with signature:
<code class="docutils literal notranslate"><span class="pre">f(mu,</span> <span class="pre">gamma,</span> <span class="pre">sigma,</span> <span class="pre">p,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">d)</span> <span class="pre">-&gt;</span> <span class="pre">dict</span></code></p></li>
</ul>
</p></li>
<li><p><strong>regularization_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional parameters for the regularization method.
For ‘fix_p’: <code class="docutils literal notranslate"><span class="pre">{'p_fixed':</span> <span class="pre">-0.5}</span></code> to fix p = -0.5 (NIG).</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for initialization.</p></li>
<li><p><strong>fix_tail</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, do not update GIG parameters (p, a, b) during fitting.
Useful for fitting special cases like VG, NIG, NInvG. Default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted distribution (returns self for method chaining).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic" title="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic">GeneralizedHyperbolic</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The EM algorithm alternates between:</p>
<p><strong>E-step</strong>: Compute conditional expectations given current parameters:</p>
<div class="math notranslate nohighlight">
\[E[Y^{-1}|X], E[Y|X], E[\log Y|X]\]</div>
<p><strong>M-step</strong>: Update parameters using closed-form solutions for normal
parameters and numerical optimization for GIG parameters.</p>
<p>After each M-step, regularization is applied to ensure identifiability.
The recommended regularization is <span class="math notranslate nohighlight">\(|\Sigma| = 1\)</span>, which doesn’t
affect EM convergence (see em_algorithm.rst for proof).</p>
<p>The initial parameters are obtained by running a short NIG EM
(5 iterations) to get a reasonable starting point for
<span class="math notranslate nohighlight">\((\mu, \gamma, \Sigma)\)</span> and the GIG parameters.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default regularization (|Σ| = 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fix p = -0.5 (NIG)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">X</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">regularization</span><span class="o">=</span><span class="s1">&#39;fix_p&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">regularization_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p_fixed&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Custom regularization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">my_regularize</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="n">mu</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>  <span class="c1"># Fix b = 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gh</span> <span class="o">=</span> <span class="n">GeneralizedHyperbolic</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">regularization</span><span class="o">=</span><span class="n">my_regularize</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the marginal distribution: <span class="math notranslate nohighlight">\(E[X] = \mu + \gamma E[Y]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> – Mean vector, shape (d,).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#GeneralizedHyperbolic.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.GeneralizedHyperbolic.var" title="Link to this definition"></a></dt>
<dd><p>Variance of the marginal distribution (diagonal elements of covariance).</p>
<div class="math notranslate nohighlight">
\[\text{Cov}[X] = E[Y] \Sigma + \text{Var}[Y] \gamma\gamma^T\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>var</strong> – Variance vector, shape (d,).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.regularize_det_sigma_one">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.generalized_hyperbolic.</span></span><span class="sig-name descname"><span class="pre">regularize_det_sigma_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#regularize_det_sigma_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_det_sigma_one" title="Link to this definition"></a></dt>
<dd><p>Regularize GH parameters by enforcing <span class="math notranslate nohighlight">\(|\Sigma| = 1\)</span>.</p>
<p>This is the recommended regularization that doesn’t affect convergence
of the EM algorithm. Following the legacy implementation:</p>
<div class="math notranslate nohighlight">
\[(\mu, \gamma, \Sigma, p, a, b) \to
(\mu, |\Sigma|^{-1/d} \gamma, |\Sigma|^{-1/d} \Sigma,
p, |\Sigma|^{-1/d} a, |\Sigma|^{1/d} b)\]</div>
<p>All computations are done in log space to avoid underflow/overflow
of the determinant in high dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>gamma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>sigma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>p</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>a</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>b</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Dimension of X.</p></li>
<li><p><strong>log_det_sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Precomputed log determinant of Sigma. If provided, avoids
recomputing the determinant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Regularized parameters with <a href="#id3"><span class="problematic" id="id4">|Σ|</span></a> = 1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.regularize_fix_p">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.generalized_hyperbolic.</span></span><span class="sig-name descname"><span class="pre">regularize_fix_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fixed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-0.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#regularize_fix_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_fix_p" title="Link to this definition"></a></dt>
<dd><p>Regularize by fixing the GIG parameter <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This converts GH to a special case:
- p = -0.5: Normal-Inverse Gaussian
- p &gt; 0 with b → 0: Variance Gamma (approximately)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>gamma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>sigma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>p</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>a</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>b</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Dimension of X.</p></li>
<li><p><strong>p_fixed</strong> (<em>float</em><em>, </em><em>optional</em>) – Fixed value for p. Default is -0.5 (NIG).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Regularized parameters with fixed p.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.regularize_none">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.generalized_hyperbolic.</span></span><span class="sig-name descname"><span class="pre">regularize_none</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#regularize_none"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_none" title="Link to this definition"></a></dt>
<dd><p>No regularization (identity function).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>gamma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>sigma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>p</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>a</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>b</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Dimension of X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Unchanged parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.distributions.mixtures.generalized_hyperbolic.regularize_sigma_diagonal_one">
<span class="sig-prename descclassname"><span class="pre">normix.distributions.mixtures.generalized_hyperbolic.</span></span><span class="sig-name descname"><span class="pre">regularize_sigma_diagonal_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/distributions/mixtures/generalized_hyperbolic.html#regularize_sigma_diagonal_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.distributions.mixtures.generalized_hyperbolic.regularize_sigma_diagonal_one" title="Link to this definition"></a></dt>
<dd><p>Regularize by enforcing the first diagonal element of <span class="math notranslate nohighlight">\(\Sigma\)</span> to be 1.</p>
<div class="math notranslate nohighlight">
\[\Sigma_{11} = 1\]</div>
<p>This is an alternative regularization useful in some applications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>gamma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>sigma</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>p</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>a</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>b</strong> (<em>parameters</em>) – Classical GH parameters.</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Dimension of X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Regularized parameters with Σ₁₁ = 1.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-normix.utils.bessel">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-normix.utils.bessel" title="Link to this heading"></a></h2>
<p>Bessel function utilities for numerical stability.</p>
<p>This module provides numerically stable implementations of log Bessel functions
that are essential for the Generalized Inverse Gaussian distribution.</p>
<p>The modified Bessel function of the second kind <span class="math notranslate nohighlight">\(K_\nu(z)\)</span> appears in the
normalizing constant of the GIG distribution:</p>
<div class="math notranslate nohighlight">
\[f(x|p,a,b) = \frac{(a/b)^{p/2}}{2 K_p(\sqrt{ab})} x^{p-1}
\exp\left(-\frac{ax + b/x}{2}\right)\]</div>
<p>For numerical stability, we work with <span class="math notranslate nohighlight">\(\log K_\nu(z)\)</span> instead of
<span class="math notranslate nohighlight">\(K_\nu(z)\)</span> directly.</p>
<dl class="py function">
<dt class="sig sig-object py" id="normix.utils.bessel.kv_ratio">
<span class="sig-prename descclassname"><span class="pre">normix.utils.bessel.</span></span><span class="sig-name descname"><span class="pre">kv_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/utils/bessel.html#kv_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.utils.bessel.kv_ratio" title="Link to this definition"></a></dt>
<dd><p>Compute the ratio K_{v1}(z) / K_{v2}(z) in a numerically stable way.</p>
<dl class="simple">
<dt>Uses log space to avoid overflow/underflow:</dt><dd><p>K_{v1}(z) / K_{v2}(z) = exp(log K_{v1}(z) - log K_{v2}(z))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<em>float</em>) – Order of numerator Bessel function.</p></li>
<li><p><strong>v2</strong> (<em>float</em>) – Order of denominator Bessel function.</p></li>
<li><p><strong>z</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Argument (must be &gt; 0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ratio</strong> – The ratio K_{v1}(z) / K_{v2}(z).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.utils.bessel.log_kv">
<span class="sig-prename descclassname"><span class="pre">normix.utils.bessel.</span></span><span class="sig-name descname"><span class="pre">log_kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/utils/bessel.html#log_kv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.utils.bessel.log_kv" title="Link to this definition"></a></dt>
<dd><p>Log modified Bessel function of the second kind: log K_v(z).</p>
<p>Computes <span class="math notranslate nohighlight">\(\log K_\nu(z)\)</span> in a numerically stable way.</p>
<p>This is an optimized version where <span class="math notranslate nohighlight">\(\nu\)</span> is a scalar and <span class="math notranslate nohighlight">\(z\)</span>
can be vectorized. For the fully vectorized version (both <span class="math notranslate nohighlight">\(\nu\)</span> and
<span class="math notranslate nohighlight">\(z\)</span> arrays), use <a class="reference internal" href="#normix.utils.bessel.log_kv_vectorized" title="normix.utils.bessel.log_kv_vectorized"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_kv_vectorized()</span></code></a>.</p>
<p>Uses the exponentially scaled function <span class="math notranslate nohighlight">\(K_\nu^e(z) = K_\nu(z) e^z\)</span> for
numerical stability when <span class="math notranslate nohighlight">\(z\)</span> is large:</p>
<div class="math notranslate nohighlight">
\[\log K_\nu(z) = \log K_\nu^e(z) - z\]</div>
<p>When the result is inf (underflow for small <span class="math notranslate nohighlight">\(z\)</span>), uses asymptotic approximations:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(|\nu| &gt; \varepsilon\)</span>:
<span class="math notranslate nohighlight">\(\log K_\nu(z) \approx \log\Gamma(|\nu|) - \log 2 + |\nu|(\log 2 - \log z)\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(|\nu| \approx 0\)</span>:
<span class="math notranslate nohighlight">\(\log K_0(z) \approx \log(-\log(z/2) - \gamma)\)</span> where <span class="math notranslate nohighlight">\(\gamma\)</span> is Euler’s constant</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>float</em>) – Order of Bessel function <span class="math notranslate nohighlight">\(\nu\)</span> (scalar).</p></li>
<li><p><strong>z</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Argument (must be &gt; 0), can be vectorized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>log_kv</strong> – <span class="math notranslate nohighlight">\(\log K_\nu(z)\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_kv</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="go">-1.9670713500717493</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_kv</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]))</span>
<span class="go">array([ 0.68024015, -0.38318674, -1.71531713])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.utils.bessel.log_kv_derivative_z">
<span class="sig-prename descclassname"><span class="pre">normix.utils.bessel.</span></span><span class="sig-name descname"><span class="pre">log_kv_derivative_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/utils/bessel.html#log_kv_derivative_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.utils.bessel.log_kv_derivative_z" title="Link to this definition"></a></dt>
<dd><p>Derivative of log(K_v(z)) with respect to z.</p>
<p>Using the recurrence relation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K</span><span class="s1">&#39;_v(z) = -(K_{v-1}(z) + K_{v+1}(z)) / 2</span>
</pre></div>
</div>
<p>So:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">/</span><span class="n">dz</span> <span class="n">log</span><span class="p">(</span><span class="n">K_v</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">=</span> <span class="n">K</span><span class="s1">&#39;_v(z) / K_v(z)</span>
                 <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">K_</span><span class="p">{</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">}(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">K_</span><span class="p">{</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">}(</span><span class="n">z</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="n">K_v</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                 <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">log</span> <span class="n">K_</span><span class="p">{</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">}(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span> <span class="n">K_v</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">+</span>
                         <span class="n">exp</span><span class="p">(</span><span class="n">log</span> <span class="n">K_</span><span class="p">{</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">}(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span> <span class="n">K_v</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>float</em>) – Order of Bessel function (scalar).</p></li>
<li><p><strong>z</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Argument (must be &gt; 0), can be vectorized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>deriv</strong> – Derivative of log K_v(z) with respect to z.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">log_kv_derivative_z</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="go">-1.3143079478654318</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="normix.utils.bessel.log_kv_vectorized">
<span class="sig-prename descclassname"><span class="pre">normix.utils.bessel.</span></span><span class="sig-name descname"><span class="pre">log_kv_vectorized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/normix/utils/bessel.html#log_kv_vectorized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#normix.utils.bessel.log_kv_vectorized" title="Link to this definition"></a></dt>
<dd><p>Log modified Bessel function of the second kind: log(K_v(z)).</p>
<p>Fully vectorized version where both v and z can be arrays.
This is slower than log_kv when v is a scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Order of Bessel function.</p></li>
<li><p><strong>z</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Argument (must be &gt; 0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>log_kv</strong> – Log of the modified Bessel function of the second kind.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../theory/generalized_enb.html" class="btn btn-neutral float-left" title="Generalized Effective Number of Bets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, normix developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>